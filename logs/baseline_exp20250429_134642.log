WARNING:training_pipeline.logger_factory:No Neptune project is specified, loggin offline. To specify Neptune project, add command line argument --neptune-project workspace/project
INFO:validator.utils:client ids loaded
INFO:validator.utils:embeddings loaded
WARNING:validator.embeddings_validator:Validator will not check if the content of client_ids.npy matches with the list of relevant clients. Embeddings may not conform to competition format.
INFO:validator.utils:client ids are valid
INFO:validator.utils:embeddings are valid
INFO:validator.utils:embeddings and client ids have the same length
INFO:validator.validate:Validator checks passed
INFO:training_pipeline.train_runner:Running on churn
INFO:training_pipeline.train_runner:Constructing task specific data structures
INFO:training_pipeline.train_runner:Transforming client ids
INFO:training_pipeline.train_runner:Setting up training logger
INFO:training_pipeline.train_runner:Running training
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA A800 80GB PCIe') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
['churn', 'propensity_category', 'propensity_sku']
[<ChurnTasks.CHURN: 'churn'>, <PropensityTasks.PROPENSITY_CATEGORY: 'propensity_category'>, <PropensityTasks.PROPENSITY_SKU: 'propensity_sku'>]
[neptune] [info   ] Neptune initialized. Open in the app: offline/f07186c8-4130-4dc5-bcce-aa19c5880846
INFO:training_pipeline.data_module:Constructing datasets
/data_sdc/mhwang/miniconda3/envs/RecSys/lib/python3.11/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:653: Checkpoint directory /data/mhwang/Rec/RecSys/recsys2025/.neptune/offline-name/OFFLINE/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
┏━━━┳━━━━━━┳━━━━━━┳━━━━━━━━┓
┃   ┃ Name ┃ Type ┃ Params ┃
┡━━━╇━━━━━━╇━━━━━━╇━━━━━━━━┩
│ 0 │ net  │ Net  │ 51.0 M │
└───┴──────┴──────┴────────┘
Trainable params: 51.0 M                                                        
Non-trainable params: 0                                                         
Total params: 51.0 M                                                            
Total estimated model params size (MB): 204                                     
/data_sdc/mhwang/miniconda3/envs/RecSys/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py:298: The number of training batches (3429) is smaller than the logging interval Trainer(log_every_n_steps=5000). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.
Epoch 0/2  ━━━━━━━━━━━━━━━ 3429/3429 0:01:10 •       48.80it/s v_num: LINE      
                                     0:00:00                   train_loss: 0.690
                                                               val_loss: 0.751  
                                                               val_auroc: 0.465 
Epoch 1/2  ━━━━━━━━━━━━━━━ 3429/3429 0:01:10 •       48.86it/s v_num: LINE      
                                     0:00:00                   train_loss: 0.682
                                                               val_loss: 0.782  
                                                               val_auroc: 0.494 
`Trainer.fit` stopped: `max_epochs=3` reached.
Epoch 2/2  ━━━━━━━━━━━━━━━ 3429/3429 0:01:10 •       48.87it/s v_num: LINE      
                                     0:00:00                   train_loss: 0.682
                                                               val_loss: 0.827  
                                                               val_auroc: 0.549 
[neptune] [info   ] Shutting down background jobs, please wait a moment...
[neptune] [info   ] Done!
INFO:training_pipeline.train_runner:Run on churn completed
INFO:training_pipeline.train_runner:Running on propensity_category
INFO:training_pipeline.train_runner:Constructing task specific data structures
INFO:training_pipeline.train_runner:Transforming client ids
INFO:training_pipeline.train_runner:Setting up training logger
INFO:training_pipeline.train_runner:Running training
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[neptune] [info   ] Neptune initialized. Open in the app: offline/8f04df47-b406-4e3d-85f4-b19c03305684
INFO:training_pipeline.data_module:Constructing datasets
/data_sdc/mhwang/miniconda3/envs/RecSys/lib/python3.11/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:653: Checkpoint directory /data/mhwang/Rec/RecSys/recsys2025/.neptune/offline-name/OFFLINE/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
┏━━━┳━━━━━━┳━━━━━━┳━━━━━━━━┓
┃   ┃ Name ┃ Type ┃ Params ┃
┡━━━╇━━━━━━╇━━━━━━╇━━━━━━━━┩
│ 0 │ net  │ Net  │ 51.2 M │
└───┴──────┴──────┴────────┘
Trainable params: 51.2 M                                                        
Non-trainable params: 0                                                         
Total params: 51.2 M                                                            
Total estimated model params size (MB): 204                                     
/data_sdc/mhwang/miniconda3/envs/RecSys/lib/python3.11/site-packages/torchmetrics/utilities/prints.py:43: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)  # noqa: B028
Epoch 0/2  ━━━━━━━━━━━━━━━ 6707/6707 0:02:18 •       48.61it/s v_num: LINE      
                                     0:00:00                   train_loss: 0.006
                                                               val_loss: 0.002  
                                                               val_auroc: 0.616 
                                                               val_diversity:   
                                                               0.876            
                                                               val_novelty:     
                                                               0.944            
Epoch 1/2  ━━━━━━━━━━━━━━━ 6707/6707 0:02:19 •       48.55it/s v_num: LINE      
                                     0:00:00                   train_loss: 0.005
                                                               val_loss: 0.002  
                                                               val_auroc: 0.625 
                                                               val_diversity:   
                                                               0.902            
                                                               val_novelty:     
                                                               0.896            
`Trainer.fit` stopped: `max_epochs=3` reached.
Epoch 2/2  ━━━━━━━━━━━━━━━ 6707/6707 0:02:18 •       48.77it/s v_num: LINE      
                                     0:00:00                   train_loss: 0.006
                                                               val_loss: 0.002  
                                                               val_auroc: 0.633 
                                                               val_diversity:   
                                                               0.908            
                                                               val_novelty:     
                                                               0.883            
[neptune] [info   ] Shutting down background jobs, please wait a moment...
[neptune] [info   ] Done!
INFO:training_pipeline.train_runner:Run on propensity_category completed
INFO:training_pipeline.train_runner:Running on propensity_sku
INFO:training_pipeline.train_runner:Constructing task specific data structures
INFO:training_pipeline.train_runner:Transforming client ids
INFO:training_pipeline.train_runner:Setting up training logger
INFO:training_pipeline.train_runner:Running training
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[neptune] [info   ] Neptune initialized. Open in the app: offline/7d30cfec-d8c3-4fd7-97fc-3c169bebefc9
INFO:training_pipeline.data_module:Constructing datasets
/data_sdc/mhwang/miniconda3/envs/RecSys/lib/python3.11/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:653: Checkpoint directory /data/mhwang/Rec/RecSys/recsys2025/.neptune/offline-name/OFFLINE/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
┏━━━┳━━━━━━┳━━━━━━┳━━━━━━━━┓
┃   ┃ Name ┃ Type ┃ Params ┃
┡━━━╇━━━━━━╇━━━━━━╇━━━━━━━━┩
│ 0 │ net  │ Net  │ 51.2 M │
└───┴──────┴──────┴────────┘
Trainable params: 51.2 M                                                        
Non-trainable params: 0                                                         
Total params: 51.2 M                                                            
Total estimated model params size (MB): 204                                     
/data_sdc/mhwang/miniconda3/envs/RecSys/lib/python3.11/site-packages/torchmetrics/utilities/prints.py:43: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)  # noqa: B028
Epoch 0/2  ━━━━━━━━━━━━━━━ 6707/6707 0:02:17 •       49.01it/s v_num: LINE      
                                     0:00:00                   train_loss: 0.000
                                                               val_loss: 0.000  
                                                               val_auroc: 0.548 
                                                               val_diversity:   
                                                               0.405            
                                                               val_novelty:     
                                                               0.992            
Epoch 1/2  ━━━━━━━━━━━━━━━ 6707/6707 0:02:18 •       48.78it/s v_num: LINE      
                                     0:00:00                   train_loss: 0.000
                                                               val_loss: 0.000  
                                                               val_auroc: 0.547 
                                                               val_diversity:   
                                                               0.729            
                                                               val_novelty:     
                                                               0.995            
`Trainer.fit` stopped: `max_epochs=3` reached.
Epoch 2/2  ━━━━━━━━━━━━━━━ 6707/6707 0:02:18 •       48.70it/s v_num: LINE      
                                     0:00:00                   train_loss: 0.000
                                                               val_loss: 0.000  
                                                               val_auroc: 0.558 
                                                               val_diversity:   
                                                               0.740            
                                                               val_novelty:     
                                                               0.995            
[neptune] [info   ] Shutting down background jobs, please wait a moment...
[neptune] [info   ] Done!
INFO:training_pipeline.train_runner:Run on propensity_sku completed

INFO:ubt_solution.config:Using CUDA version: 11.8
INFO:ubt_solution.data_processor:内存使用情况 [初始化数据集开始] - RSS: 547.75 MB, VMS: 23750.80 MB
INFO:ubt_solution.data_processor:正在加载相关用户ID，文件路径: /data/mhwang/Rec/RecSys/recsys2025/data/input/relevant_clients.npy
INFO:ubt_solution.data_processor:测试模式：只处理前 10000 个用户
INFO:ubt_solution.data_processor:系统可用内存: 335.91 GB
INFO:ubt_solution.data_processor:根据系统内存自动设置块大小为: 20000
INFO:ubt_solution.data_processor:将用户分成 1 个块进行处理，每块大约 20000 个用户
INFO:ubt_solution.data_processor:内存使用情况 [开始分块加载事件数据] - RSS: 555.57 MB, VMS: 23758.43 MB
INFO:ubt_solution.data_processor:处理用户块 1/1
INFO:ubt_solution.data_processor:开始并行加载当前块的事件数据...
INFO:ubt_solution.data_processor:正在加载 product_buy 数据，文件路径: /data/mhwang/Rec/RecSys/recsys2025/data/product_buy.parquet
INFO:ubt_solution.data_processor:正在加载 add_to_cart 数据，文件路径: /data/mhwang/Rec/RecSys/recsys2025/data/add_to_cart.parquet
INFO:ubt_solution.data_processor:正在加载 remove_from_cart 数据，文件路径: /data/mhwang/Rec/RecSys/recsys2025/data/remove_from_cart.parquet
INFO:ubt_solution.data_processor:正在加载 page_visit 数据，文件路径: /data/mhwang/Rec/RecSys/recsys2025/data/page_visit.parquet
INFO:ubt_solution.data_processor:正在加载 search_query 数据，文件路径: /data/mhwang/Rec/RecSys/recsys2025/data/search_query.parquet
WARNING:ubt_solution.data_processor:直接过滤失败，将读取所有数据后在内存中过滤: ParquetFile.iter_batches() got an unexpected keyword argument 'filters'
WARNING:ubt_solution.data_processor:直接过滤失败，将读取所有数据后在内存中过滤: ParquetFile.iter_batches() got an unexpected keyword argument 'filters'
WARNING:ubt_solution.data_processor:直接过滤失败，将读取所有数据后在内存中过滤: ParquetFile.iter_batches() got an unexpected keyword argument 'filters'
WARNING:ubt_solution.data_processor:直接过滤失败，将读取所有数据后在内存中过滤: ParquetFile.iter_batches() got an unexpected keyword argument 'filters'
WARNING:ubt_solution.data_processor:直接过滤失败，将读取所有数据后在内存中过滤: ParquetFile.iter_batches() got an unexpected keyword argument 'filters'
INFO:ubt_solution.data_processor:remove_from_cart 数据加载完成，形状: (39490, 4)
INFO:ubt_solution.data_processor:product_buy 数据加载完成，形状: (44985, 4)
INFO:ubt_solution.data_processor:add_to_cart 数据加载完成，形状: (87008, 4)
INFO:ubt_solution.data_processor:search_query 数据加载完成，形状: (156434, 5)
INFO:ubt_solution.data_processor:page_visit 数据加载完成，形状: (1213783, 4)
INFO:ubt_solution.data_processor:内存使用情况 [块 1 事件数据加载完成] - RSS: 1370.46 MB, VMS: 26671.28 MB
INFO:ubt_solution.data_processor:开始加载商品属性数据...
INFO:ubt_solution.data_processor:正在加载商品属性数据，文件路径: /data/mhwang/Rec/RecSys/recsys2025/data/product_properties.parquet
INFO:ubt_solution.data_processor:商品属性数据加载完成，形状: (1197634, 4)
INFO:ubt_solution.data_processor:商品属性数据加载完成
INFO:ubt_solution.data_processor:开始构建用户块 1 的序列...
INFO:ubt_solution.data_processor:开始构建用户序列...
INFO:ubt_solution.data_processor:内存使用情况 [开始构建用户序列] - RSS: 1566.48 MB, VMS: 26849.13 MB
INFO:ubt_solution.data_processor:合并事件数据...
INFO:ubt_solution.data_processor:预计合并 1541700 行事件数据
INFO:ubt_solution.data_processor:优化数据类型以减少内存占用...
INFO:ubt_solution.data_processor:处理时间戳...
INFO:ubt_solution.data_processor:内存使用情况 [事件数据合并和类型优化完成] - RSS: 1722.84 MB, VMS: 26993.57 MB
INFO:ubt_solution.data_processor:按用户分组预处理事件...
INFO:ubt_solution.data_processor:在事件数据中发现 10000 个用户
INFO:ubt_solution.data_processor:每用户平均事件数: 154.2, 设置批次大小: 5000
INFO:ubt_solution.data_processor:处理用户批次 1/2，包含 5000 个用户
处理用户序列:   0%|          | 0/5000 [00:00<?, ?it/s]处理用户序列:   0%|          | 1/5000 [00:00<15:24,  5.40it/s]处理用户序列:   0%|          | 6/5000 [00:00<03:24, 24.41it/s]处理用户序列:   0%|          | 15/5000 [00:00<01:42, 48.81it/s]处理用户序列:   0%|          | 23/5000 [00:00<01:25, 57.90it/s]处理用户序列:   1%|          | 33/5000 [00:00<01:11, 69.50it/s]处理用户序列:   1%|          | 46/5000 [00:00<00:56, 87.13it/s]处理用户序列:   1%|          | 58/5000 [00:00<00:52, 94.53it/s]处理用户序列:   1%|▏         | 68/5000 [00:00<00:51, 95.49it/s]处理用户序列:   2%|▏         | 78/5000 [00:01<00:53, 91.97it/s]处理用户序列:   2%|▏         | 88/5000 [00:01<00:52, 93.43it/s]处理用户序列:   2%|▏         | 98/5000 [00:01<00:51, 94.70it/s]处理用户序列:   2%|▏         | 108/5000 [00:01<00:56, 87.09it/s]处理用户序列:   2%|▏         | 117/5000 [00:01<00:56, 86.33it/s]处理用户序列:   3%|▎         | 127/5000 [00:01<00:54, 89.36it/s]处理用户序列:   3%|▎         | 137/5000 [00:01<01:00, 80.66it/s]处理用户序列:   3%|▎         | 148/5000 [00:01<00:56, 85.95it/s]处理用户序列:   3%|▎         | 158/5000 [00:01<00:56, 86.44it/s]处理用户序列:   3%|▎         | 167/5000 [00:02<00:57, 84.53it/s]处理用户序列:   4%|▎         | 177/5000 [00:02<00:54, 88.41it/s]处理用户序列:   4%|▎         | 186/5000 [00:02<00:54, 87.56it/s]处理用户序列:   4%|▍         | 195/5000 [00:02<00:56, 85.06it/s]处理用户序列:   4%|▍         | 204/5000 [00:02<00:58, 81.81it/s]处理用户序列:   4%|▍         | 216/5000 [00:02<00:51, 92.12it/s]处理用户序列:   5%|▍         | 227/5000 [00:02<00:49, 95.48it/s]处理用户序列:   5%|▍         | 237/5000 [00:02<00:50, 94.98it/s]处理用户序列:   5%|▍         | 247/5000 [00:02<00:53, 89.44it/s]处理用户序列:   5%|▌         | 257/5000 [00:03<00:54, 86.84it/s]处理用户序列:   5%|▌         | 266/5000 [00:03<01:01, 77.48it/s]处理用户序列:   5%|▌         | 274/5000 [00:03<01:01, 76.55it/s]处理用户序列:   6%|▌         | 285/5000 [00:03<00:56, 82.81it/s]处理用户序列:   6%|▌         | 294/5000 [00:03<00:58, 80.18it/s]处理用户序列:   6%|▌         | 309/5000 [00:03<00:50, 93.55it/s]处理用户序列:   6%|▋         | 319/5000 [00:03<00:50, 92.02it/s]处理用户序列:   7%|▋         | 329/5000 [00:03<00:55, 84.47it/s]处理用户序列:   7%|▋         | 339/5000 [00:04<00:52, 88.21it/s]处理用户序列:   7%|▋         | 348/5000 [00:04<00:56, 82.00it/s]处理用户序列:   7%|▋         | 357/5000 [00:04<00:55, 83.19it/s]处理用户序列:   7%|▋         | 366/5000 [00:04<00:58, 79.08it/s]处理用户序列:   8%|▊         | 377/5000 [00:04<00:54, 85.48it/s]处理用户序列:   8%|▊         | 386/5000 [00:04<00:55, 82.97it/s]处理用户序列:   8%|▊         | 396/5000 [00:04<00:52, 86.87it/s]处理用户序列:   8%|▊         | 405/5000 [00:04<00:54, 83.82it/s]处理用户序列:   8%|▊         | 417/5000 [00:04<00:49, 93.52it/s]处理用户序列:   9%|▊         | 427/5000 [00:05<00:48, 93.57it/s]处理用户序列:   9%|▊         | 437/5000 [00:05<00:48, 93.69it/s]处理用户序列:   9%|▉         | 447/5000 [00:05<00:48, 93.95it/s]处理用户序列:   9%|▉         | 459/5000 [00:05<00:45, 100.29it/s]处理用户序列:   9%|▉         | 470/5000 [00:05<00:47, 95.69it/s] 处理用户序列:  10%|▉         | 480/5000 [00:05<00:49, 91.94it/s]处理用户序列:  10%|▉         | 491/5000 [00:05<00:47, 94.82it/s]处理用户序列:  10%|█         | 502/5000 [00:05<00:46, 97.58it/s]处理用户序列:  10%|█         | 512/5000 [00:05<00:49, 89.78it/s]处理用户序列:  11%|█         | 526/5000 [00:06<00:45, 98.22it/s]处理用户序列:  11%|█         | 536/5000 [00:06<00:45, 98.27it/s]处理用户序列:  11%|█         | 547/5000 [00:06<00:43, 101.27it/s]处理用户序列:  11%|█         | 558/5000 [00:06<00:43, 101.79it/s]处理用户序列:  11%|█▏        | 570/5000 [00:06<00:43, 102.61it/s]处理用户序列:  12%|█▏        | 581/5000 [00:06<00:46, 95.40it/s] 处理用户序列:  12%|█▏        | 591/5000 [00:06<00:46, 94.18it/s]处理用户序列:  12%|█▏        | 601/5000 [00:06<00:46, 94.49it/s]处理用户序列:  12%|█▏        | 612/5000 [00:06<00:44, 98.35it/s]处理用户序列:  12%|█▏        | 622/5000 [00:07<00:47, 92.99it/s]处理用户序列:  13%|█▎        | 632/5000 [00:07<00:48, 90.97it/s]处理用户序列:  13%|█▎        | 642/5000 [00:07<00:47, 91.44it/s]处理用户序列:  13%|█▎        | 653/5000 [00:07<00:45, 96.23it/s]处理用户序列:  13%|█▎        | 665/5000 [00:07<00:42, 102.86it/s]处理用户序列:  14%|█▎        | 676/5000 [00:07<00:44, 96.20it/s] 处理用户序列:  14%|█▎        | 686/5000 [00:07<00:45, 94.48it/s]处理用户序列:  14%|█▍        | 697/5000 [00:07<00:44, 95.73it/s]处理用户序列:  14%|█▍        | 707/5000 [00:08<00:48, 87.95it/s]处理用户序列:  14%|█▍        | 716/5000 [00:08<00:53, 80.03it/s]处理用户序列:  15%|█▍        | 728/5000 [00:08<00:49, 86.14it/s]处理用户序列:  15%|█▍        | 737/5000 [00:08<00:49, 85.81it/s]处理用户序列:  15%|█▍        | 746/5000 [00:08<00:49, 86.06it/s]处理用户序列:  15%|█▌        | 755/5000 [00:08<00:53, 79.33it/s]处理用户序列:  15%|█▌        | 765/5000 [00:08<00:50, 84.57it/s]处理用户序列:  16%|█▌        | 777/5000 [00:08<00:45, 92.69it/s]处理用户序列:  16%|█▌        | 787/5000 [00:08<00:47, 88.04it/s]处理用户序列:  16%|█▌        | 798/5000 [00:09<00:45, 92.31it/s]处理用户序列:  16%|█▌        | 808/5000 [00:09<00:45, 92.04it/s]处理用户序列:  16%|█▋        | 818/5000 [00:09<00:45, 91.45it/s]处理用户序列:  17%|█▋        | 828/5000 [00:09<00:51, 80.34it/s]处理用户序列:  17%|█▋        | 837/5000 [00:09<00:51, 81.11it/s]处理用户序列:  17%|█▋        | 846/5000 [00:09<00:52, 79.88it/s]处理用户序列:  17%|█▋        | 858/5000 [00:09<00:46, 89.60it/s]处理用户序列:  17%|█▋        | 868/5000 [00:09<00:45, 91.71it/s]处理用户序列:  18%|█▊        | 879/5000 [00:09<00:44, 93.41it/s]处理用户序列:  18%|█▊        | 890/5000 [00:10<00:43, 93.54it/s]处理用户序列:  18%|█▊        | 900/5000 [00:10<00:43, 94.03it/s]处理用户序列:  18%|█▊        | 912/5000 [00:10<00:41, 98.15it/s]处理用户序列:  18%|█▊        | 922/5000 [00:10<00:42, 96.24it/s]处理用户序列:  19%|█▊        | 932/5000 [00:10<00:42, 95.30it/s]处理用户序列:  19%|█▉        | 942/5000 [00:10<00:44, 91.32it/s]处理用户序列:  19%|█▉        | 955/5000 [00:10<00:40, 98.80it/s]处理用户序列:  19%|█▉        | 966/5000 [00:10<00:41, 97.64it/s]处理用户序列:  20%|█▉        | 976/5000 [00:11<00:45, 88.58it/s]处理用户序列:  20%|█▉        | 986/5000 [00:11<00:45, 88.28it/s]处理用户序列:  20%|█▉        | 995/5000 [00:11<00:46, 85.49it/s]处理用户序列:  20%|██        | 1008/5000 [00:11<00:42, 93.69it/s]处理用户序列:  20%|██        | 1019/5000 [00:11<00:42, 93.67it/s]处理用户序列:  21%|██        | 1031/5000 [00:11<00:39, 99.41it/s]处理用户序列:  21%|██        | 1042/5000 [00:11<00:40, 98.25it/s]处理用户序列:  21%|██        | 1053/5000 [00:11<00:39, 98.76it/s]处理用户序列:  21%|██▏       | 1065/5000 [00:11<00:39, 99.55it/s]处理用户序列:  22%|██▏       | 1075/5000 [00:12<00:44, 88.78it/s]处理用户序列:  22%|██▏       | 1090/5000 [00:12<00:38, 101.49it/s]处理用户序列:  22%|██▏       | 1101/5000 [00:12<00:41, 94.63it/s] 处理用户序列:  22%|██▏       | 1113/5000 [00:12<00:39, 97.43it/s]处理用户序列:  22%|██▏       | 1123/5000 [00:12<00:45, 85.67it/s]处理用户序列:  23%|██▎       | 1132/5000 [00:12<00:44, 86.21it/s]处理用户序列:  23%|██▎       | 1143/5000 [00:12<00:43, 87.75it/s]处理用户序列:  23%|██▎       | 1154/5000 [00:12<00:41, 92.71it/s]处理用户序列:  23%|██▎       | 1164/5000 [00:13<00:41, 92.44it/s]处理用户序列:  23%|██▎       | 1174/5000 [00:13<00:42, 90.80it/s]处理用户序列:  24%|██▎       | 1184/5000 [00:13<00:44, 85.67it/s]处理用户序列:  24%|██▍       | 1193/5000 [00:13<00:46, 82.02it/s]处理用户序列:  24%|██▍       | 1202/5000 [00:13<00:46, 80.89it/s]处理用户序列:  24%|██▍       | 1211/5000 [00:13<00:47, 79.36it/s]处理用户序列:  24%|██▍       | 1220/5000 [00:13<00:47, 79.24it/s]处理用户序列:  25%|██▍       | 1229/5000 [00:13<00:47, 79.39it/s]处理用户序列:  25%|██▍       | 1241/5000 [00:13<00:43, 86.78it/s]处理用户序列:  25%|██▌       | 1250/5000 [00:14<00:43, 86.43it/s]处理用户序列:  25%|██▌       | 1260/5000 [00:14<00:41, 89.87it/s]处理用户序列:  25%|██▌       | 1270/5000 [00:14<00:47, 78.13it/s]处理用户序列:  26%|██▌       | 1280/5000 [00:14<00:44, 83.15it/s]处理用户序列:  26%|██▌       | 1292/5000 [00:14<00:40, 91.57it/s]处理用户序列:  26%|██▌       | 1303/5000 [00:14<00:39, 94.21it/s]处理用户序列:  26%|██▋       | 1313/5000 [00:14<00:41, 87.98it/s]处理用户序列:  26%|██▋       | 1324/5000 [00:14<00:39, 92.08it/s]处理用户序列:  27%|██▋       | 1334/5000 [00:15<00:39, 93.67it/s]处理用户序列:  27%|██▋       | 1344/5000 [00:15<00:39, 92.07it/s]处理用户序列:  27%|██▋       | 1355/5000 [00:15<00:39, 91.60it/s]处理用户序列:  27%|██▋       | 1367/5000 [00:15<00:36, 98.41it/s]处理用户序列:  28%|██▊       | 1377/5000 [00:15<00:37, 97.65it/s]处理用户序列:  28%|██▊       | 1389/5000 [00:15<00:35, 100.81it/s]处理用户序列:  28%|██▊       | 1400/5000 [00:15<00:34, 103.09it/s]处理用户序列:  28%|██▊       | 1411/5000 [00:15<00:35, 100.29it/s]处理用户序列:  28%|██▊       | 1422/5000 [00:15<00:35, 99.74it/s] 处理用户序列:  29%|██▊       | 1433/5000 [00:16<00:37, 95.69it/s]处理用户序列:  29%|██▉       | 1443/5000 [00:16<00:38, 91.41it/s]处理用户序列:  29%|██▉       | 1453/5000 [00:16<00:40, 87.74it/s]处理用户序列:  29%|██▉       | 1462/5000 [00:16<00:41, 85.47it/s]处理用户序列:  29%|██▉       | 1472/5000 [00:16<00:39, 89.26it/s]处理用户序列:  30%|██▉       | 1481/5000 [00:16<00:41, 84.36it/s]处理用户序列:  30%|██▉       | 1491/5000 [00:16<00:40, 87.48it/s]处理用户序列:  30%|███       | 1501/5000 [00:16<00:39, 88.85it/s]处理用户序列:  30%|███       | 1510/5000 [00:16<00:40, 85.62it/s]处理用户序列:  30%|███       | 1520/5000 [00:17<00:40, 86.99it/s]处理用户序列:  31%|███       | 1529/5000 [00:17<00:40, 86.23it/s]处理用户序列:  31%|███       | 1538/5000 [00:17<00:41, 82.51it/s]处理用户序列:  31%|███       | 1547/5000 [00:17<00:42, 80.71it/s]处理用户序列:  31%|███       | 1556/5000 [00:17<00:44, 77.41it/s]处理用户序列:  31%|███▏      | 1566/5000 [00:17<00:41, 81.97it/s]处理用户序列:  32%|███▏      | 1575/5000 [00:17<00:43, 77.95it/s]处理用户序列:  32%|███▏      | 1583/5000 [00:17<00:43, 77.75it/s]处理用户序列:  32%|███▏      | 1591/5000 [00:17<00:44, 76.77it/s]处理用户序列:  32%|███▏      | 1602/5000 [00:18<00:39, 85.72it/s]处理用户序列:  32%|███▏      | 1611/5000 [00:18<00:40, 83.81it/s]处理用户序列:  32%|███▏      | 1620/5000 [00:18<00:39, 85.32it/s]处理用户序列:  33%|███▎      | 1630/5000 [00:18<00:38, 87.94it/s]处理用户序列:  33%|███▎      | 1640/5000 [00:18<00:36, 90.83it/s]处理用户序列:  33%|███▎      | 1650/5000 [00:18<00:36, 91.45it/s]处理用户序列:  33%|███▎      | 1664/5000 [00:18<00:32, 103.64it/s]处理用户序列:  34%|███▎      | 1675/5000 [00:18<00:32, 102.76it/s]处理用户序列:  34%|███▎      | 1686/5000 [00:18<00:36, 90.29it/s] 处理用户序列:  34%|███▍      | 1698/5000 [00:19<00:34, 95.91it/s]处理用户序列:  34%|███▍      | 1708/5000 [00:19<00:37, 88.14it/s]处理用户序列:  34%|███▍      | 1720/5000 [00:19<00:34, 93.95it/s]处理用户序列:  35%|███▍      | 1730/5000 [00:19<00:36, 90.54it/s]处理用户序列:  35%|███▍      | 1740/5000 [00:19<00:38, 84.27it/s]处理用户序列:  35%|███▍      | 1749/5000 [00:19<00:40, 81.02it/s]处理用户序列:  35%|███▌      | 1759/5000 [00:19<00:38, 84.96it/s]处理用户序列:  35%|███▌      | 1768/5000 [00:19<00:38, 84.55it/s]处理用户序列:  36%|███▌      | 1778/5000 [00:20<00:36, 88.23it/s]处理用户序列:  36%|███▌      | 1787/5000 [00:20<00:36, 87.76it/s]处理用户序列:  36%|███▌      | 1796/5000 [00:20<00:40, 79.66it/s]处理用户序列:  36%|███▌      | 1805/5000 [00:20<00:39, 81.24it/s]处理用户序列:  36%|███▋      | 1816/5000 [00:20<00:37, 84.94it/s]处理用户序列:  37%|███▋      | 1827/5000 [00:20<00:35, 89.11it/s]处理用户序列:  37%|███▋      | 1836/5000 [00:20<00:37, 85.19it/s]处理用户序列:  37%|███▋      | 1845/5000 [00:20<00:38, 82.42it/s]处理用户序列:  37%|███▋      | 1856/5000 [00:20<00:35, 89.73it/s]处理用户序列:  37%|███▋      | 1868/5000 [00:21<00:32, 95.73it/s]处理用户序列:  38%|███▊      | 1880/5000 [00:21<00:31, 99.30it/s]处理用户序列:  38%|███▊      | 1890/5000 [00:21<00:31, 97.20it/s]处理用户序列:  38%|███▊      | 1900/5000 [00:21<00:36, 85.75it/s]处理用户序列:  38%|███▊      | 1911/5000 [00:21<00:34, 89.73it/s]处理用户序列:  38%|███▊      | 1921/5000 [00:21<00:35, 86.60it/s]处理用户序列:  39%|███▊      | 1930/5000 [00:21<00:36, 85.15it/s]处理用户序列:  39%|███▉      | 1939/5000 [00:21<00:35, 86.14it/s]处理用户序列:  39%|███▉      | 1948/5000 [00:21<00:38, 80.03it/s]处理用户序列:  39%|███▉      | 1960/5000 [00:22<00:34, 88.43it/s]处理用户序列:  39%|███▉      | 1969/5000 [00:22<00:35, 84.98it/s]处理用户序列:  40%|███▉      | 1978/5000 [00:22<00:36, 83.74it/s]处理用户序列:  40%|███▉      | 1988/5000 [00:22<00:34, 86.11it/s]处理用户序列:  40%|████      | 2001/5000 [00:22<00:30, 97.68it/s]处理用户序列:  40%|████      | 2011/5000 [00:22<00:31, 94.59it/s]处理用户序列:  40%|████      | 2021/5000 [00:22<00:33, 89.13it/s]处理用户序列:  41%|████      | 2032/5000 [00:22<00:31, 92.91it/s]处理用户序列:  41%|████      | 2043/5000 [00:22<00:30, 96.66it/s]处理用户序列:  41%|████      | 2056/5000 [00:23<00:27, 105.35it/s]处理用户序列:  41%|████▏     | 2067/5000 [00:23<00:28, 102.46it/s]处理用户序列:  42%|████▏     | 2078/5000 [00:23<00:29, 97.70it/s] 处理用户序列:  42%|████▏     | 2091/5000 [00:23<00:27, 104.35it/s]处理用户序列:  42%|████▏     | 2102/5000 [00:23<00:27, 104.42it/s]处理用户序列:  42%|████▏     | 2113/5000 [00:23<00:27, 104.98it/s]处理用户序列:  42%|████▏     | 2124/5000 [00:23<00:29, 98.48it/s] 处理用户序列:  43%|████▎     | 2134/5000 [00:23<00:31, 91.51it/s]处理用户序列:  43%|████▎     | 2144/5000 [00:24<00:32, 88.13it/s]处理用户序列:  43%|████▎     | 2155/5000 [00:24<00:31, 90.91it/s]处理用户序列:  43%|████▎     | 2165/5000 [00:24<00:30, 92.98it/s]处理用户序列:  44%|████▎     | 2178/5000 [00:24<00:27, 102.28it/s]处理用户序列:  44%|████▍     | 2190/5000 [00:24<00:26, 106.23it/s]处理用户序列:  44%|████▍     | 2201/5000 [00:24<00:28, 99.83it/s] 处理用户序列:  44%|████▍     | 2212/5000 [00:24<00:29, 95.29it/s]处理用户序列:  44%|████▍     | 2222/5000 [00:24<00:29, 94.87it/s]处理用户序列:  45%|████▍     | 2232/5000 [00:24<00:30, 90.97it/s]处理用户序列:  45%|████▍     | 2244/5000 [00:25<00:28, 97.91it/s]处理用户序列:  45%|████▌     | 2254/5000 [00:25<00:28, 95.49it/s]处理用户序列:  45%|████▌     | 2265/5000 [00:25<00:28, 96.09it/s]处理用户序列:  46%|████▌     | 2275/5000 [00:25<00:29, 91.18it/s]处理用户序列:  46%|████▌     | 2285/5000 [00:25<00:30, 87.95it/s]处理用户序列:  46%|████▌     | 2296/5000 [00:25<00:29, 91.33it/s]处理用户序列:  46%|████▌     | 2307/5000 [00:25<00:29, 92.74it/s]处理用户序列:  46%|████▋     | 2317/5000 [00:25<00:29, 89.87it/s]处理用户序列:  47%|████▋     | 2328/5000 [00:25<00:28, 92.20it/s]处理用户序列:  47%|████▋     | 2338/5000 [00:26<00:31, 84.63it/s]处理用户序列:  47%|████▋     | 2347/5000 [00:26<00:33, 80.26it/s]处理用户序列:  47%|████▋     | 2356/5000 [00:26<00:33, 78.43it/s]处理用户序列:  47%|████▋     | 2364/5000 [00:26<00:33, 78.51it/s]处理用户序列:  47%|████▋     | 2372/5000 [00:26<00:34, 76.66it/s]处理用户序列:  48%|████▊     | 2380/5000 [00:26<00:34, 76.58it/s]处理用户序列:  48%|████▊     | 2388/5000 [00:26<00:35, 74.06it/s]处理用户序列:  48%|████▊     | 2396/5000 [00:26<00:35, 72.88it/s]处理用户序列:  48%|████▊     | 2405/5000 [00:27<00:34, 75.40it/s]处理用户序列:  48%|████▊     | 2413/5000 [00:27<00:36, 71.30it/s]处理用户序列:  48%|████▊     | 2424/5000 [00:27<00:31, 81.62it/s]处理用户序列:  49%|████▊     | 2433/5000 [00:27<00:31, 81.61it/s]处理用户序列:  49%|████▉     | 2443/5000 [00:27<00:30, 84.16it/s]处理用户序列:  49%|████▉     | 2455/5000 [00:27<00:27, 93.88it/s]处理用户序列:  49%|████▉     | 2465/5000 [00:27<00:28, 90.36it/s]处理用户序列:  50%|████▉     | 2475/5000 [00:27<00:29, 86.66it/s]处理用户序列:  50%|████▉     | 2488/5000 [00:27<00:26, 94.17it/s]处理用户序列:  50%|████▉     | 2498/5000 [00:28<00:27, 90.36it/s]处理用户序列:  50%|█████     | 2508/5000 [00:28<00:29, 85.32it/s]处理用户序列:  50%|█████     | 2523/5000 [00:28<00:24, 101.94it/s]处理用户序列:  51%|█████     | 2534/5000 [00:28<00:25, 97.86it/s] 处理用户序列:  51%|█████     | 2545/5000 [00:28<00:26, 93.57it/s]处理用户序列:  51%|█████     | 2555/5000 [00:28<00:26, 92.37it/s]处理用户序列:  51%|█████▏    | 2565/5000 [00:28<00:27, 89.66it/s]处理用户序列:  52%|█████▏    | 2575/5000 [00:28<00:26, 91.92it/s]处理用户序列:  52%|█████▏    | 2585/5000 [00:29<00:27, 86.48it/s]处理用户序列:  52%|█████▏    | 2599/5000 [00:29<00:24, 98.88it/s]处理用户序列:  52%|█████▏    | 2611/5000 [00:29<00:22, 104.31it/s]处理用户序列:  52%|█████▏    | 2622/5000 [00:29<00:25, 94.48it/s] 处理用户序列:  53%|█████▎    | 2635/5000 [00:29<00:23, 101.03it/s]处理用户序列:  53%|█████▎    | 2648/5000 [00:29<00:22, 106.89it/s]处理用户序列:  53%|█████▎    | 2659/5000 [00:29<00:23, 100.46it/s]处理用户序列:  53%|█████▎    | 2670/5000 [00:29<00:24, 96.49it/s] 处理用户序列:  54%|█████▎    | 2680/5000 [00:29<00:25, 90.90it/s]处理用户序列:  54%|█████▍    | 2690/5000 [00:30<00:26, 86.90it/s]处理用户序列:  54%|█████▍    | 2699/5000 [00:30<00:28, 79.43it/s]处理用户序列:  54%|█████▍    | 2708/5000 [00:30<00:29, 77.80it/s]处理用户序列:  54%|█████▍    | 2716/5000 [00:30<00:29, 76.37it/s]处理用户序列:  55%|█████▍    | 2725/5000 [00:30<00:28, 78.89it/s]处理用户序列:  55%|█████▍    | 2736/5000 [00:30<00:26, 85.93it/s]处理用户序列:  55%|█████▍    | 2745/5000 [00:30<00:28, 80.23it/s]处理用户序列:  55%|█████▌    | 2754/5000 [00:30<00:28, 79.81it/s]处理用户序列:  55%|█████▌    | 2765/5000 [00:31<00:25, 86.22it/s]处理用户序列:  56%|█████▌    | 2776/5000 [00:31<00:24, 91.40it/s]处理用户序列:  56%|█████▌    | 2787/5000 [00:31<00:23, 93.12it/s]处理用户序列:  56%|█████▌    | 2797/5000 [00:31<00:25, 86.08it/s]处理用户序列:  56%|█████▌    | 2806/5000 [00:31<00:27, 80.60it/s]处理用户序列:  56%|█████▋    | 2815/5000 [00:31<00:26, 82.07it/s]处理用户序列:  57%|█████▋    | 2828/5000 [00:31<00:23, 93.73it/s]处理用户序列:  57%|█████▋    | 2838/5000 [00:31<00:22, 94.76it/s]处理用户序列:  57%|█████▋    | 2851/5000 [00:31<00:20, 103.86it/s]处理用户序列:  57%|█████▋    | 2862/5000 [00:32<00:24, 87.46it/s] 处理用户序列:  57%|█████▋    | 2872/5000 [00:32<00:24, 85.72it/s]处理用户序列:  58%|█████▊    | 2881/5000 [00:32<00:26, 81.31it/s]处理用户序列:  58%|█████▊    | 2891/5000 [00:32<00:24, 84.42it/s]处理用户序列:  58%|█████▊    | 2902/5000 [00:32<00:23, 89.25it/s]处理用户序列:  58%|█████▊    | 2912/5000 [00:32<00:24, 85.95it/s]处理用户序列:  58%|█████▊    | 2921/5000 [00:32<00:24, 84.99it/s]处理用户序列:  59%|█████▊    | 2930/5000 [00:32<00:25, 80.48it/s]处理用户序列:  59%|█████▉    | 2939/5000 [00:33<00:26, 78.92it/s]处理用户序列:  59%|█████▉    | 2951/5000 [00:33<00:23, 88.89it/s]处理用户序列:  59%|█████▉    | 2961/5000 [00:33<00:23, 88.29it/s]处理用户序列:  59%|█████▉    | 2972/5000 [00:33<00:22, 89.43it/s]处理用户序列:  60%|█████▉    | 2984/5000 [00:33<00:21, 94.13it/s]处理用户序列:  60%|█████▉    | 2994/5000 [00:33<00:21, 94.45it/s]处理用户序列:  60%|██████    | 3004/5000 [00:33<00:20, 95.48it/s]处理用户序列:  60%|██████    | 3014/5000 [00:33<00:20, 96.45it/s]处理用户序列:  60%|██████    | 3024/5000 [00:33<00:21, 92.15it/s]处理用户序列:  61%|██████    | 3035/5000 [00:34<00:21, 91.76it/s]处理用户序列:  61%|██████    | 3047/5000 [00:34<00:19, 98.33it/s]处理用户序列:  61%|██████    | 3057/5000 [00:34<00:19, 97.23it/s]处理用户序列:  61%|██████▏   | 3067/5000 [00:34<00:19, 97.46it/s]处理用户序列:  62%|██████▏   | 3078/5000 [00:34<00:20, 95.46it/s]处理用户序列:  62%|██████▏   | 3088/5000 [00:34<00:21, 89.88it/s]处理用户序列:  62%|██████▏   | 3102/5000 [00:34<00:18, 101.25it/s]处理用户序列:  62%|██████▏   | 3113/5000 [00:34<00:19, 97.31it/s] 处理用户序列:  62%|██████▏   | 3123/5000 [00:34<00:20, 91.82it/s]处理用户序列:  63%|██████▎   | 3133/5000 [00:35<00:22, 82.73it/s]处理用户序列:  63%|██████▎   | 3144/5000 [00:35<00:21, 86.94it/s]处理用户序列:  63%|██████▎   | 3153/5000 [00:35<00:21, 86.42it/s]处理用户序列:  63%|██████▎   | 3165/5000 [00:35<00:19, 92.05it/s]处理用户序列:  64%|██████▎   | 3176/5000 [00:35<00:19, 95.91it/s]处理用户序列:  64%|██████▎   | 3186/5000 [00:35<00:21, 83.72it/s]处理用户序列:  64%|██████▍   | 3199/5000 [00:35<00:19, 93.16it/s]处理用户序列:  64%|██████▍   | 3209/5000 [00:35<00:19, 89.84it/s]处理用户序列:  64%|██████▍   | 3219/5000 [00:36<00:19, 90.61it/s]处理用户序列:  65%|██████▍   | 3229/5000 [00:36<00:20, 87.78it/s]处理用户序列:  65%|██████▍   | 3238/5000 [00:36<00:21, 82.93it/s]处理用户序列:  65%|██████▌   | 3251/5000 [00:36<00:18, 94.90it/s]处理用户序列:  65%|██████▌   | 3261/5000 [00:36<00:20, 85.52it/s]处理用户序列:  65%|██████▌   | 3270/5000 [00:36<00:20, 84.52it/s]处理用户序列:  66%|██████▌   | 3281/5000 [00:36<00:19, 89.94it/s]处理用户序列:  66%|██████▌   | 3292/5000 [00:36<00:18, 91.24it/s]处理用户序列:  66%|██████▌   | 3302/5000 [00:36<00:18, 92.05it/s]处理用户序列:  66%|██████▌   | 3312/5000 [00:37<00:18, 92.93it/s]处理用户序列:  66%|██████▋   | 3322/5000 [00:37<00:18, 92.60it/s]处理用户序列:  67%|██████▋   | 3332/5000 [00:37<00:20, 82.23it/s]处理用户序列:  67%|██████▋   | 3343/5000 [00:37<00:19, 87.04it/s]处理用户序列:  67%|██████▋   | 3352/5000 [00:37<00:20, 81.21it/s]处理用户序列:  67%|██████▋   | 3361/5000 [00:37<00:19, 82.73it/s]处理用户序列:  67%|██████▋   | 3370/5000 [00:37<00:19, 82.03it/s]处理用户序列:  68%|██████▊   | 3380/5000 [00:37<00:18, 85.81it/s]处理用户序列:  68%|██████▊   | 3391/5000 [00:38<00:17, 91.36it/s]处理用户序列:  68%|██████▊   | 3401/5000 [00:38<00:18, 87.87it/s]处理用户序列:  68%|██████▊   | 3410/5000 [00:38<00:19, 83.31it/s]处理用户序列:  68%|██████▊   | 3419/5000 [00:38<00:19, 82.86it/s]处理用户序列:  69%|██████▊   | 3430/5000 [00:38<00:17, 89.85it/s]处理用户序列:  69%|██████▉   | 3440/5000 [00:38<00:17, 91.53it/s]处理用户序列:  69%|██████▉   | 3450/5000 [00:38<00:17, 89.89it/s]处理用户序列:  69%|██████▉   | 3461/5000 [00:38<00:16, 92.37it/s]处理用户序列:  69%|██████▉   | 3471/5000 [00:38<00:17, 87.29it/s]处理用户序列:  70%|██████▉   | 3480/5000 [00:39<00:17, 87.77it/s]处理用户序列:  70%|██████▉   | 3491/5000 [00:39<00:16, 91.57it/s]处理用户序列:  70%|███████   | 3507/5000 [00:39<00:13, 110.57it/s]处理用户序列:  70%|███████   | 3519/5000 [00:39<00:15, 98.66it/s] 处理用户序列:  71%|███████   | 3530/5000 [00:39<00:15, 97.26it/s]处理用户序列:  71%|███████   | 3540/5000 [00:39<00:15, 91.88it/s]处理用户序列:  71%|███████   | 3550/5000 [00:39<00:16, 87.09it/s]处理用户序列:  71%|███████   | 3559/5000 [00:39<00:18, 79.79it/s]处理用户序列:  71%|███████▏  | 3573/5000 [00:40<00:15, 92.94it/s]处理用户序列:  72%|███████▏  | 3583/5000 [00:40<00:15, 90.73it/s]处理用户序列:  72%|███████▏  | 3593/5000 [00:40<00:16, 87.74it/s]处理用户序列:  72%|███████▏  | 3602/5000 [00:40<00:16, 84.06it/s]处理用户序列:  72%|███████▏  | 3611/5000 [00:40<00:17, 80.95it/s]处理用户序列:  72%|███████▏  | 3620/5000 [00:40<00:16, 81.39it/s]处理用户序列:  73%|███████▎  | 3630/5000 [00:40<00:16, 83.21it/s]处理用户序列:  73%|███████▎  | 3640/5000 [00:40<00:15, 87.57it/s]处理用户序列:  73%|███████▎  | 3649/5000 [00:40<00:15, 85.17it/s]处理用户序列:  73%|███████▎  | 3660/5000 [00:41<00:14, 90.15it/s]处理用户序列:  73%|███████▎  | 3670/5000 [00:41<00:14, 91.07it/s]处理用户序列:  74%|███████▎  | 3680/5000 [00:41<00:14, 91.45it/s]处理用户序列:  74%|███████▍  | 3691/5000 [00:41<00:13, 96.43it/s]处理用户序列:  74%|███████▍  | 3701/5000 [00:41<00:14, 91.35it/s]处理用户序列:  74%|███████▍  | 3711/5000 [00:41<00:16, 79.04it/s]处理用户序列:  74%|███████▍  | 3722/5000 [00:41<00:15, 82.83it/s]处理用户序列:  75%|███████▍  | 3731/5000 [00:41<00:15, 81.28it/s]处理用户序列:  75%|███████▍  | 3741/5000 [00:41<00:14, 85.90it/s]处理用户序列:  75%|███████▌  | 3750/5000 [00:42<00:14, 85.87it/s]处理用户序列:  75%|███████▌  | 3761/5000 [00:42<00:13, 90.22it/s]处理用户序列:  75%|███████▌  | 3771/5000 [00:42<00:13, 90.69it/s]处理用户序列:  76%|███████▌  | 3781/5000 [00:42<00:13, 91.12it/s]处理用户序列:  76%|███████▌  | 3791/5000 [00:42<00:13, 86.89it/s]处理用户序列:  76%|███████▌  | 3803/5000 [00:42<00:13, 91.11it/s]处理用户序列:  76%|███████▋  | 3815/5000 [00:42<00:12, 98.56it/s]处理用户序列:  76%|███████▋  | 3825/5000 [00:42<00:11, 98.40it/s]处理用户序列:  77%|███████▋  | 3835/5000 [00:42<00:12, 91.58it/s]处理用户序列:  77%|███████▋  | 3847/5000 [00:43<00:11, 97.72it/s]处理用户序列:  77%|███████▋  | 3857/5000 [00:43<00:11, 98.23it/s]处理用户序列:  77%|███████▋  | 3867/5000 [00:43<00:12, 89.90it/s]处理用户序列:  78%|███████▊  | 3877/5000 [00:43<00:12, 88.01it/s]处理用户序列:  78%|███████▊  | 3886/5000 [00:43<00:18, 59.51it/s]处理用户序列:  78%|███████▊  | 3894/5000 [00:43<00:17, 62.21it/s]处理用户序列:  78%|███████▊  | 3908/5000 [00:43<00:13, 78.69it/s]处理用户序列:  78%|███████▊  | 3918/5000 [00:44<00:13, 78.42it/s]处理用户序列:  79%|███████▊  | 3929/5000 [00:44<00:12, 84.91it/s]处理用户序列:  79%|███████▉  | 3939/5000 [00:44<00:12, 85.01it/s]处理用户序列:  79%|███████▉  | 3948/5000 [00:44<00:12, 84.98it/s]处理用户序列:  79%|███████▉  | 3957/5000 [00:44<00:13, 75.13it/s]处理用户序列:  79%|███████▉  | 3968/5000 [00:44<00:12, 82.91it/s]处理用户序列:  80%|███████▉  | 3980/5000 [00:44<00:11, 91.70it/s]处理用户序列:  80%|███████▉  | 3995/5000 [00:44<00:09, 106.04it/s]处理用户序列:  80%|████████  | 4006/5000 [00:44<00:09, 105.00it/s]处理用户序列:  80%|████████  | 4017/5000 [00:45<00:10, 94.36it/s] 处理用户序列:  81%|████████  | 4027/5000 [00:45<00:10, 91.76it/s]处理用户序列:  81%|████████  | 4037/5000 [00:45<00:10, 91.12it/s]处理用户序列:  81%|████████  | 4047/5000 [00:45<00:10, 89.84it/s]处理用户序列:  81%|████████  | 4057/5000 [00:45<00:11, 85.29it/s]处理用户序列:  81%|████████▏ | 4067/5000 [00:45<00:10, 86.77it/s]处理用户序列:  82%|████████▏ | 4080/5000 [00:45<00:09, 97.74it/s]处理用户序列:  82%|████████▏ | 4090/5000 [00:45<00:09, 96.83it/s]处理用户序列:  82%|████████▏ | 4102/5000 [00:46<00:09, 98.15it/s]处理用户序列:  82%|████████▏ | 4112/5000 [00:46<00:10, 88.73it/s]处理用户序列:  82%|████████▏ | 4123/5000 [00:46<00:09, 91.61it/s]处理用户序列:  83%|████████▎ | 4133/5000 [00:46<00:09, 88.88it/s]处理用户序列:  83%|████████▎ | 4143/5000 [00:46<00:09, 89.53it/s]处理用户序列:  83%|████████▎ | 4153/5000 [00:46<00:09, 88.64it/s]处理用户序列:  83%|████████▎ | 4164/5000 [00:46<00:09, 90.55it/s]处理用户序列:  83%|████████▎ | 4174/5000 [00:46<00:09, 90.15it/s]处理用户序列:  84%|████████▎ | 4184/5000 [00:46<00:09, 88.46it/s]处理用户序列:  84%|████████▍ | 4194/5000 [00:47<00:08, 90.01it/s]处理用户序列:  84%|████████▍ | 4204/5000 [00:47<00:10, 79.47it/s]处理用户序列:  84%|████████▍ | 4214/5000 [00:47<00:09, 80.54it/s]处理用户序列:  84%|████████▍ | 4225/5000 [00:47<00:08, 86.51it/s]处理用户序列:  85%|████████▍ | 4234/5000 [00:47<00:09, 83.07it/s]处理用户序列:  85%|████████▍ | 4245/5000 [00:47<00:08, 87.88it/s]处理用户序列:  85%|████████▌ | 4255/5000 [00:47<00:08, 90.28it/s]处理用户序列:  85%|████████▌ | 4266/5000 [00:47<00:07, 95.44it/s]处理用户序列:  86%|████████▌ | 4276/5000 [00:48<00:07, 91.66it/s]处理用户序列:  86%|████████▌ | 4287/5000 [00:48<00:07, 96.28it/s]处理用户序列:  86%|████████▌ | 4297/5000 [00:48<00:08, 87.31it/s]处理用户序列:  86%|████████▌ | 4307/5000 [00:48<00:07, 88.20it/s]处理用户序列:  86%|████████▋ | 4317/5000 [00:48<00:07, 89.51it/s]处理用户序列:  87%|████████▋ | 4327/5000 [00:48<00:08, 80.33it/s]处理用户序列:  87%|████████▋ | 4336/5000 [00:48<00:08, 79.27it/s]处理用户序列:  87%|████████▋ | 4345/5000 [00:48<00:08, 79.46it/s]处理用户序列:  87%|████████▋ | 4356/5000 [00:48<00:07, 86.59it/s]处理用户序列:  87%|████████▋ | 4365/5000 [00:49<00:07, 86.80it/s]处理用户序列:  88%|████████▊ | 4376/5000 [00:49<00:07, 88.77it/s]处理用户序列:  88%|████████▊ | 4385/5000 [00:49<00:07, 85.76it/s]处理用户序列:  88%|████████▊ | 4395/5000 [00:49<00:06, 86.77it/s]处理用户序列:  88%|████████▊ | 4404/5000 [00:49<00:07, 82.25it/s]处理用户序列:  88%|████████▊ | 4415/5000 [00:49<00:06, 87.81it/s]处理用户序列:  88%|████████▊ | 4425/5000 [00:49<00:06, 90.00it/s]处理用户序列:  89%|████████▊ | 4435/5000 [00:49<00:06, 91.24it/s]处理用户序列:  89%|████████▉ | 4450/5000 [00:49<00:05, 102.06it/s]处理用户序列:  89%|████████▉ | 4461/5000 [00:50<00:05, 101.31it/s]处理用户序列:  89%|████████▉ | 4472/5000 [00:50<00:05, 93.16it/s] 处理用户序列:  90%|████████▉ | 4482/5000 [00:50<00:05, 92.06it/s]处理用户序列:  90%|████████▉ | 4493/5000 [00:50<00:05, 94.52it/s]处理用户序列:  90%|█████████ | 4503/5000 [00:50<00:05, 94.17it/s]处理用户序列:  90%|█████████ | 4513/5000 [00:50<00:05, 91.00it/s]处理用户序列:  90%|█████████ | 4525/5000 [00:50<00:04, 98.62it/s]处理用户序列:  91%|█████████ | 4539/5000 [00:50<00:04, 107.77it/s]处理用户序列:  91%|█████████ | 4550/5000 [00:51<00:04, 107.80it/s]处理用户序列:  91%|█████████ | 4561/5000 [00:51<00:04, 101.41it/s]处理用户序列:  91%|█████████▏| 4572/5000 [00:51<00:04, 95.69it/s] 处理用户序列:  92%|█████████▏| 4582/5000 [00:51<00:04, 91.92it/s]处理用户序列:  92%|█████████▏| 4592/5000 [00:51<00:04, 88.33it/s]处理用户序列:  92%|█████████▏| 4603/5000 [00:51<00:04, 93.88it/s]处理用户序列:  92%|█████████▏| 4613/5000 [00:51<00:04, 92.41it/s]处理用户序列:  92%|█████████▏| 4624/5000 [00:51<00:03, 96.89it/s]处理用户序列:  93%|█████████▎| 4634/5000 [00:51<00:03, 91.86it/s]处理用户序列:  93%|█████████▎| 4644/5000 [00:52<00:03, 92.51it/s]处理用户序列:  93%|█████████▎| 4654/5000 [00:52<00:04, 86.14it/s]处理用户序列:  93%|█████████▎| 4665/5000 [00:52<00:03, 92.44it/s]处理用户序列:  94%|█████████▎| 4675/5000 [00:52<00:03, 88.46it/s]处理用户序列:  94%|█████████▎| 4687/5000 [00:52<00:03, 96.90it/s]处理用户序列:  94%|█████████▍| 4697/5000 [00:52<00:03, 89.85it/s]处理用户序列:  94%|█████████▍| 4707/5000 [00:52<00:03, 84.03it/s]处理用户序列:  94%|█████████▍| 4716/5000 [00:52<00:03, 77.70it/s]处理用户序列:  94%|█████████▍| 4725/5000 [00:53<00:03, 79.72it/s]处理用户序列:  95%|█████████▍| 4735/5000 [00:53<00:03, 81.97it/s]处理用户序列:  95%|█████████▍| 4744/5000 [00:53<00:03, 82.55it/s]处理用户序列:  95%|█████████▌| 4756/5000 [00:53<00:02, 90.13it/s]处理用户序列:  95%|█████████▌| 4766/5000 [00:53<00:02, 91.33it/s]处理用户序列:  96%|█████████▌| 4776/5000 [00:53<00:02, 88.18it/s]处理用户序列:  96%|█████████▌| 4785/5000 [00:53<00:02, 86.18it/s]处理用户序列:  96%|█████████▌| 4794/5000 [00:53<00:02, 84.74it/s]处理用户序列:  96%|█████████▌| 4803/5000 [00:53<00:02, 82.29it/s]处理用户序列:  96%|█████████▋| 4813/5000 [00:54<00:02, 84.84it/s]处理用户序列:  96%|█████████▋| 4822/5000 [00:54<00:02, 81.23it/s]处理用户序列:  97%|█████████▋| 4832/5000 [00:54<00:01, 84.33it/s]处理用户序列:  97%|█████████▋| 4842/5000 [00:54<00:01, 88.54it/s]处理用户序列:  97%|█████████▋| 4851/5000 [00:54<00:01, 87.55it/s]处理用户序列:  97%|█████████▋| 4860/5000 [00:54<00:01, 86.30it/s]处理用户序列:  97%|█████████▋| 4871/5000 [00:54<00:01, 88.89it/s]处理用户序列:  98%|█████████▊| 4880/5000 [00:54<00:01, 85.30it/s]处理用户序列:  98%|█████████▊| 4891/5000 [00:54<00:01, 90.92it/s]处理用户序列:  98%|█████████▊| 4901/5000 [00:55<00:01, 86.77it/s]处理用户序列:  98%|█████████▊| 4910/5000 [00:55<00:01, 85.71it/s]处理用户序列:  98%|█████████▊| 4919/5000 [00:55<00:01, 79.70it/s]处理用户序列:  99%|█████████▊| 4928/5000 [00:55<00:00, 78.12it/s]处理用户序列:  99%|█████████▊| 4936/5000 [00:55<00:00, 77.96it/s]处理用户序列:  99%|█████████▉| 4948/5000 [00:55<00:00, 88.59it/s]处理用户序列:  99%|█████████▉| 4959/5000 [00:55<00:00, 90.37it/s]处理用户序列:  99%|█████████▉| 4969/5000 [00:55<00:00, 84.71it/s]处理用户序列: 100%|█████████▉| 4981/5000 [00:55<00:00, 92.08it/s]处理用户序列: 100%|█████████▉| 4991/5000 [00:56<00:00, 86.93it/s]处理用户序列: 100%|██████████| 5000/5000 [00:56<00:00, 88.97it/s]
INFO:ubt_solution.data_processor:内存使用情况 [用户批次 1/2 处理完成] - RSS: 1931.16 MB, VMS: 27211.04 MB
INFO:ubt_solution.data_processor:处理用户批次 2/2，包含 5000 个用户
处理用户序列:   0%|          | 0/5000 [00:00<?, ?it/s]处理用户序列:   0%|          | 17/5000 [00:00<00:34, 144.30it/s]处理用户序列:   1%|          | 48/5000 [00:00<00:21, 227.61it/s]处理用户序列:   2%|▏         | 80/5000 [00:00<00:18, 265.26it/s]处理用户序列:   2%|▏         | 117/5000 [00:00<00:16, 304.15it/s]处理用户序列:   3%|▎         | 148/5000 [00:00<00:16, 287.02it/s]处理用户序列:   4%|▎         | 178/5000 [00:00<00:16, 290.92it/s]处理用户序列:   4%|▍         | 208/5000 [00:00<00:16, 290.04it/s]处理用户序列:   5%|▍         | 241/5000 [00:00<00:15, 301.99it/s]处理用户序列:   5%|▌         | 272/5000 [00:00<00:15, 297.79it/s]处理用户序列:   6%|▌         | 302/5000 [00:01<00:16, 290.92it/s]处理用户序列:   7%|▋         | 336/5000 [00:01<00:15, 304.70it/s]处理用户序列:   7%|▋         | 371/5000 [00:01<00:14, 316.54it/s]处理用户序列:   8%|▊         | 403/5000 [00:01<00:14, 311.64it/s]处理用户序列:   9%|▉         | 438/5000 [00:01<00:14, 308.67it/s]处理用户序列:   9%|▉         | 469/5000 [00:01<00:14, 303.34it/s]处理用户序列:  10%|█         | 500/5000 [00:01<00:15, 286.20it/s]处理用户序列:  11%|█         | 531/5000 [00:01<00:15, 292.09it/s]处理用户序列:  11%|█         | 561/5000 [00:01<00:15, 291.82it/s]处理用户序列:  12%|█▏        | 591/5000 [00:02<00:15, 277.35it/s]处理用户序列:  12%|█▏        | 619/5000 [00:02<00:17, 255.16it/s]处理用户序列:  13%|█▎        | 646/5000 [00:02<00:16, 258.36it/s]处理用户序列:  14%|█▎        | 678/5000 [00:02<00:16, 269.67it/s]处理用户序列:  14%|█▍        | 713/5000 [00:02<00:14, 290.32it/s]处理用户序列:  15%|█▍        | 743/5000 [00:02<00:15, 274.98it/s]处理用户序列:  16%|█▌        | 777/5000 [00:02<00:14, 292.25it/s]处理用户序列:  16%|█▌        | 807/5000 [00:02<00:15, 276.58it/s]处理用户序列:  17%|█▋        | 836/5000 [00:02<00:15, 267.08it/s]处理用户序列:  17%|█▋        | 865/5000 [00:03<00:15, 272.33it/s]处理用户序列:  18%|█▊        | 896/5000 [00:03<00:14, 282.23it/s]处理用户序列:  19%|█▊        | 927/5000 [00:03<00:14, 286.86it/s]处理用户序列:  19%|█▉        | 961/5000 [00:03<00:13, 301.90it/s]处理用户序列:  20%|█▉        | 998/5000 [00:03<00:12, 316.00it/s]处理用户序列:  21%|██        | 1030/5000 [00:03<00:13, 296.57it/s]处理用户序列:  21%|██▏       | 1066/5000 [00:03<00:12, 309.54it/s]处理用户序列:  22%|██▏       | 1098/5000 [00:03<00:12, 302.24it/s]处理用户序列:  23%|██▎       | 1129/5000 [00:03<00:12, 299.62it/s]处理用户序列:  23%|██▎       | 1160/5000 [00:04<00:13, 286.47it/s]处理用户序列:  24%|██▍       | 1189/5000 [00:04<00:13, 280.30it/s]处理用户序列:  24%|██▍       | 1218/5000 [00:04<00:13, 282.40it/s]处理用户序列:  25%|██▍       | 1248/5000 [00:04<00:13, 287.16it/s]处理用户序列:  26%|██▌       | 1277/5000 [00:04<00:14, 257.56it/s]处理用户序列:  26%|██▋       | 1314/5000 [00:04<00:12, 287.50it/s]处理用户序列:  27%|██▋       | 1344/5000 [00:04<00:13, 279.96it/s]处理用户序列:  28%|██▊       | 1386/5000 [00:04<00:11, 317.97it/s]处理用户序列:  28%|██▊       | 1419/5000 [00:04<00:11, 304.72it/s]处理用户序列:  29%|██▉       | 1458/5000 [00:05<00:10, 327.00it/s]处理用户序列:  30%|██▉       | 1492/5000 [00:05<00:10, 325.84it/s]处理用户序列:  30%|███       | 1525/5000 [00:05<00:10, 320.51it/s]处理用户序列:  31%|███       | 1558/5000 [00:05<00:11, 305.22it/s]处理用户序列:  32%|███▏      | 1591/5000 [00:05<00:10, 309.94it/s]处理用户序列:  32%|███▏      | 1623/5000 [00:05<00:12, 263.98it/s]处理用户序列:  33%|███▎      | 1651/5000 [00:05<00:12, 264.66it/s]处理用户序列:  34%|███▎      | 1687/5000 [00:05<00:12, 274.69it/s]处理用户序列:  34%|███▍      | 1716/5000 [00:05<00:11, 274.75it/s]处理用户序列:  35%|███▌      | 1757/5000 [00:06<00:10, 299.11it/s]处理用户序列:  36%|███▌      | 1788/5000 [00:06<00:11, 290.90it/s]处理用户序列:  36%|███▋      | 1821/5000 [00:06<00:10, 300.81it/s]处理用户序列:  37%|███▋      | 1852/5000 [00:06<00:10, 289.23it/s]处理用户序列:  38%|███▊      | 1882/5000 [00:06<00:10, 288.40it/s]处理用户序列:  38%|███▊      | 1911/5000 [00:06<00:11, 270.42it/s]处理用户序列:  39%|███▉      | 1945/5000 [00:06<00:10, 287.95it/s]处理用户序列:  40%|███▉      | 1975/5000 [00:06<00:10, 278.56it/s]处理用户序列:  40%|████      | 2004/5000 [00:06<00:10, 281.61it/s]处理用户序列:  41%|████      | 2033/5000 [00:07<00:10, 281.07it/s]处理用户序列:  41%|████▏     | 2064/5000 [00:07<00:10, 286.66it/s]处理用户序列:  42%|████▏     | 2095/5000 [00:07<00:09, 291.93it/s]处理用户序列:  42%|████▎     | 2125/5000 [00:07<00:09, 291.60it/s]处理用户序列:  43%|████▎     | 2155/5000 [00:07<00:09, 293.76it/s]处理用户序列:  44%|████▎     | 2185/5000 [00:07<00:09, 290.11it/s]处理用户序列:  44%|████▍     | 2215/5000 [00:07<00:10, 273.20it/s]处理用户序列:  45%|████▍     | 2246/5000 [00:07<00:09, 282.97it/s]处理用户序列:  46%|████▌     | 2276/5000 [00:07<00:09, 287.36it/s]处理用户序列:  46%|████▌     | 2306/5000 [00:07<00:09, 290.58it/s]处理用户序列:  47%|████▋     | 2337/5000 [00:08<00:09, 293.19it/s]处理用户序列:  47%|████▋     | 2367/5000 [00:08<00:09, 286.16it/s]处理用户序列:  48%|████▊     | 2400/5000 [00:08<00:08, 297.31it/s]处理用户序列:  49%|████▊     | 2430/5000 [00:08<00:08, 292.64it/s]处理用户序列:  49%|████▉     | 2460/5000 [00:08<00:09, 274.26it/s]处理用户序列:  50%|████▉     | 2493/5000 [00:08<00:08, 287.82it/s]处理用户序列:  50%|█████     | 2523/5000 [00:08<00:08, 290.98it/s]处理用户序列:  51%|█████     | 2558/5000 [00:08<00:07, 307.75it/s]处理用户序列:  52%|█████▏    | 2592/5000 [00:08<00:07, 315.12it/s]处理用户序列:  52%|█████▏    | 2624/5000 [00:09<00:08, 295.74it/s]处理用户序列:  53%|█████▎    | 2656/5000 [00:09<00:07, 301.02it/s]处理用户序列:  54%|█████▎    | 2687/5000 [00:09<00:08, 277.29it/s]处理用户序列:  54%|█████▍    | 2720/5000 [00:09<00:07, 290.23it/s]处理用户序列:  55%|█████▌    | 2750/5000 [00:09<00:08, 279.55it/s]处理用户序列:  56%|█████▌    | 2779/5000 [00:09<00:08, 271.50it/s]处理用户序列:  56%|█████▌    | 2807/5000 [00:09<00:08, 254.74it/s]处理用户序列:  57%|█████▋    | 2850/5000 [00:09<00:07, 299.71it/s]处理用户序列:  58%|█████▊    | 2891/5000 [00:09<00:06, 327.31it/s]处理用户序列:  58%|█████▊    | 2925/5000 [00:10<00:06, 301.51it/s]处理用户序列:  59%|█████▉    | 2956/5000 [00:10<00:06, 301.21it/s]处理用户序列:  60%|█████▉    | 2987/5000 [00:10<00:06, 289.13it/s]处理用户序列:  60%|██████    | 3017/5000 [00:10<00:07, 276.15it/s]处理用户序列:  61%|██████    | 3052/5000 [00:10<00:06, 295.80it/s]处理用户序列:  62%|██████▏   | 3083/5000 [00:10<00:06, 276.76it/s]处理用户序列:  62%|██████▏   | 3115/5000 [00:10<00:06, 286.21it/s]处理用户序列:  63%|██████▎   | 3145/5000 [00:10<00:06, 280.85it/s]处理用户序列:  63%|██████▎   | 3174/5000 [00:11<00:06, 270.20it/s]处理用户序列:  64%|██████▍   | 3207/5000 [00:11<00:06, 284.94it/s]处理用户序列:  65%|██████▍   | 3236/5000 [00:11<00:06, 268.26it/s]处理用户序列:  66%|██████▌   | 3275/5000 [00:11<00:05, 299.52it/s]处理用户序列:  66%|██████▌   | 3312/5000 [00:11<00:05, 318.85it/s]处理用户序列:  67%|██████▋   | 3349/5000 [00:11<00:04, 330.88it/s]处理用户序列:  68%|██████▊   | 3383/5000 [00:11<00:05, 295.15it/s]处理用户序列:  68%|██████▊   | 3414/5000 [00:11<00:05, 280.95it/s]处理用户序列:  69%|██████▉   | 3443/5000 [00:11<00:05, 276.56it/s]处理用户序列:  69%|██████▉   | 3472/5000 [00:12<00:05, 276.05it/s]处理用户序列:  70%|███████   | 3503/5000 [00:12<00:05, 283.95it/s]处理用户序列:  71%|███████   | 3532/5000 [00:12<00:05, 282.36it/s]处理用户序列:  71%|███████▏  | 3564/5000 [00:12<00:04, 292.43it/s]处理用户序列:  72%|███████▏  | 3595/5000 [00:12<00:04, 288.60it/s]处理用户序列:  72%|███████▎  | 3625/5000 [00:12<00:04, 283.59it/s]处理用户序列:  73%|███████▎  | 3654/5000 [00:12<00:04, 279.60it/s]处理用户序列:  74%|███████▎  | 3685/5000 [00:12<00:04, 281.19it/s]处理用户序列:  74%|███████▍  | 3716/5000 [00:12<00:04, 279.06it/s]处理用户序列:  75%|███████▍  | 3744/5000 [00:12<00:04, 277.30it/s]处理用户序列:  75%|███████▌  | 3772/5000 [00:13<00:04, 277.82it/s]处理用户序列:  76%|███████▌  | 3802/5000 [00:13<00:04, 272.14it/s]处理用户序列:  77%|███████▋  | 3830/5000 [00:13<00:04, 271.03it/s]处理用户序列:  77%|███████▋  | 3858/5000 [00:13<00:04, 271.76it/s]处理用户序列:  78%|███████▊  | 3893/5000 [00:13<00:03, 292.64it/s]处理用户序列:  78%|███████▊  | 3923/5000 [00:13<00:04, 267.39it/s]处理用户序列:  79%|███████▉  | 3957/5000 [00:13<00:03, 286.77it/s]处理用户序列:  80%|███████▉  | 3993/5000 [00:13<00:03, 303.58it/s]处理用户序列:  81%|████████  | 4033/5000 [00:13<00:03, 314.16it/s]处理用户序列:  81%|████████▏ | 4065/5000 [00:14<00:03, 297.98it/s]处理用户序列:  82%|████████▏ | 4096/5000 [00:14<00:03, 297.51it/s]处理用户序列:  83%|████████▎ | 4126/5000 [00:14<00:03, 266.32it/s]处理用户序列:  83%|████████▎ | 4154/5000 [00:14<00:03, 261.79it/s]处理用户序列:  84%|████████▍ | 4190/5000 [00:14<00:02, 285.33it/s]处理用户序列:  84%|████████▍ | 4220/5000 [00:14<00:02, 276.15it/s]处理用户序列:  85%|████████▍ | 4248/5000 [00:14<00:02, 274.06it/s]处理用户序列:  86%|████████▌ | 4276/5000 [00:14<00:02, 261.80it/s]处理用户序列:  86%|████████▌ | 4307/5000 [00:14<00:02, 273.14it/s]处理用户序列:  87%|████████▋ | 4335/5000 [00:15<00:02, 267.02it/s]处理用户序列:  87%|████████▋ | 4363/5000 [00:15<00:02, 270.58it/s]处理用户序列:  88%|████████▊ | 4391/5000 [00:15<00:02, 260.89it/s]处理用户序列:  88%|████████▊ | 4420/5000 [00:15<00:02, 268.65it/s]处理用户序列:  89%|████████▉ | 4451/5000 [00:15<00:01, 279.65it/s]处理用户序列:  90%|████████▉ | 4481/5000 [00:15<00:01, 284.67it/s]处理用户序列:  90%|█████████ | 4515/5000 [00:15<00:01, 299.08it/s]处理用户序列:  91%|█████████ | 4546/5000 [00:15<00:01, 285.04it/s]处理用户序列:  92%|█████████▏| 4575/5000 [00:15<00:01, 281.31it/s]处理用户序列:  92%|█████████▏| 4608/5000 [00:16<00:01, 294.72it/s]处理用户序列:  93%|█████████▎| 4647/5000 [00:16<00:01, 315.94it/s]处理用户序列:  94%|█████████▎| 4679/5000 [00:16<00:01, 283.22it/s]处理用户序列:  94%|█████████▍| 4716/5000 [00:16<00:00, 304.86it/s]处理用户序列:  95%|█████████▍| 4748/5000 [00:16<00:00, 292.48it/s]处理用户序列:  96%|█████████▌| 4781/5000 [00:16<00:00, 294.46it/s]处理用户序列:  96%|█████████▋| 4817/5000 [00:16<00:00, 311.87it/s]处理用户序列:  97%|█████████▋| 4849/5000 [00:16<00:00, 291.18it/s]处理用户序列:  98%|█████████▊| 4881/5000 [00:16<00:00, 296.09it/s]处理用户序列:  98%|█████████▊| 4919/5000 [00:17<00:00, 318.03it/s]处理用户序列:  99%|█████████▉| 4952/5000 [00:17<00:00, 292.34it/s]处理用户序列: 100%|█████████▉| 4982/5000 [00:17<00:00, 250.94it/s]处理用户序列: 100%|██████████| 5000/5000 [00:17<00:00, 286.90it/s]
INFO:ubt_solution.data_processor:成功将 10000 个用户序列保存到缓存文件 /data/mhwang/Rec/RecSys/recsys2025/ubt_solution/ubt_solution/cache/user_sequences_479641934112442117.pkl
INFO:ubt_solution.data_processor:内存使用情况 [用户序列构建完成] - RSS: 1968.96 MB, VMS: 27250.04 MB
INFO:ubt_solution.data_processor:成功构建了 10000 个用户序列
INFO:ubt_solution.data_processor:块 1 处理完成，耗时: 169.35 秒
INFO:ubt_solution.data_processor:内存使用情况 [块 1 处理完成] - RSS: 1892.31 MB, VMS: 27173.26 MB
INFO:ubt_solution.data_processor:用户序列构建完成，共 10000 个用户
INFO:ubt_solution.data_processor:创建商品属性查找字典...
INFO:ubt_solution.data_processor:商品属性字典创建完成，包含 1197634 个商品
INFO:ubt_solution.data_processor:设置样本缓存大小为 5000
INFO:ubt_solution.data_processor:内存使用情况 [数据集初始化完成] - RSS: 2248.66 MB, VMS: 27524.26 MB
INFO:ubt_solution.data_processor:内存使用情况 [初始化数据集开始] - RSS: 2248.66 MB, VMS: 27524.26 MB
INFO:ubt_solution.data_processor:正在加载相关用户ID，文件路径: /data/mhwang/Rec/RecSys/recsys2025/data/input/relevant_clients.npy
INFO:ubt_solution.data_processor:测试模式：只处理前 10000 个用户
INFO:ubt_solution.data_processor:系统可用内存: 332.25 GB
INFO:ubt_solution.data_processor:根据系统内存自动设置块大小为: 20000
INFO:ubt_solution.data_processor:将用户分成 1 个块进行处理，每块大约 20000 个用户
INFO:ubt_solution.data_processor:内存使用情况 [开始分块加载事件数据] - RSS: 2248.66 MB, VMS: 27524.26 MB
INFO:ubt_solution.data_processor:处理用户块 1/1
INFO:ubt_solution.data_processor:开始并行加载当前块的事件数据...
INFO:ubt_solution.data_processor:正在加载 product_buy 数据，文件路径: /data/mhwang/Rec/RecSys/recsys2025/data/product_buy.parquet
INFO:ubt_solution.data_processor:正在加载 add_to_cart 数据，文件路径: /data/mhwang/Rec/RecSys/recsys2025/data/add_to_cart.parquet
INFO:ubt_solution.data_processor:正在加载 remove_from_cart 数据，文件路径: /data/mhwang/Rec/RecSys/recsys2025/data/remove_from_cart.parquet
INFO:ubt_solution.data_processor:正在加载 page_visit 数据，文件路径: /data/mhwang/Rec/RecSys/recsys2025/data/page_visit.parquet
INFO:ubt_solution.data_processor:正在加载 search_query 数据，文件路径: /data/mhwang/Rec/RecSys/recsys2025/data/search_query.parquet
WARNING:ubt_solution.data_processor:直接过滤失败，将读取所有数据后在内存中过滤: ParquetFile.iter_batches() got an unexpected keyword argument 'filters'
WARNING:ubt_solution.data_processor:直接过滤失败，将读取所有数据后在内存中过滤: ParquetFile.iter_batches() got an unexpected keyword argument 'filters'
WARNING:ubt_solution.data_processor:直接过滤失败，将读取所有数据后在内存中过滤: ParquetFile.iter_batches() got an unexpected keyword argument 'filters'
WARNING:ubt_solution.data_processor:直接过滤失败，将读取所有数据后在内存中过滤: ParquetFile.iter_batches() got an unexpected keyword argument 'filters'
WARNING:ubt_solution.data_processor:直接过滤失败，将读取所有数据后在内存中过滤: ParquetFile.iter_batches() got an unexpected keyword argument 'filters'
INFO:ubt_solution.data_processor:product_buy 数据加载完成，形状: (44985, 4)
INFO:ubt_solution.data_processor:remove_from_cart 数据加载完成，形状: (39490, 4)
INFO:ubt_solution.data_processor:add_to_cart 数据加载完成，形状: (87008, 4)
INFO:ubt_solution.data_processor:search_query 数据加载完成，形状: (156434, 5)
INFO:ubt_solution.data_processor:page_visit 数据加载完成，形状: (1213783, 4)
INFO:ubt_solution.data_processor:内存使用情况 [块 1 事件数据加载完成] - RSS: 2424.89 MB, VMS: 28287.31 MB
INFO:ubt_solution.data_processor:开始加载商品属性数据...
INFO:ubt_solution.data_processor:正在加载商品属性数据，文件路径: /data/mhwang/Rec/RecSys/recsys2025/data/product_properties.parquet
INFO:ubt_solution.data_processor:商品属性数据加载完成，形状: (1197634, 4)
INFO:ubt_solution.data_processor:商品属性数据加载完成
INFO:ubt_solution.data_processor:开始构建用户块 1 的序列...
INFO:ubt_solution.data_processor:开始构建用户序列...
INFO:ubt_solution.data_processor:内存使用情况 [开始构建用户序列] - RSS: 2534.15 MB, VMS: 28400.58 MB
INFO:ubt_solution.data_processor:找到缓存文件 /data/mhwang/Rec/RecSys/recsys2025/ubt_solution/ubt_solution/cache/user_sequences_479641934112442117.pkl，尝试加载...
INFO:ubt_solution.data_processor:成功从缓存加载 10000 个用户序列
INFO:ubt_solution.data_processor:块 1 处理完成，耗时: 92.25 秒
INFO:ubt_solution.data_processor:内存使用情况 [块 1 处理完成] - RSS: 2742.52 MB, VMS: 28608.58 MB
INFO:ubt_solution.data_processor:用户序列构建完成，共 10000 个用户
INFO:ubt_solution.data_processor:创建商品属性查找字典...
INFO:ubt_solution.data_processor:商品属性字典创建完成，包含 1197634 个商品
INFO:ubt_solution.data_processor:设置样本缓存大小为 5000
INFO:ubt_solution.data_processor:内存使用情况 [数据集初始化完成] - RSS: 3131.05 MB, VMS: 28978.45 MB
/data_sdc/mhwang/miniconda3/envs/RecSys/lib/python3.11/site-packages/torch/nn/modules/transformer.py:379: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
/data_sdc/mhwang/miniconda3/envs/RecSys/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
INFO:__main__:开始训练模型...
INFO:ubt_solution.trainer:Epoch 1/15
Training:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.trainer:Batch 0: 开始训练
INFO:ubt_solution.trainer:Batch 0: 品类倾向性标签比例 = 20.92%
INFO:ubt_solution.trainer:Batch 0: 产品倾向性标签比例 = 2.32%
INFO:ubt_solution.model:品类倾向性: 857/4096 样本有标签 (20.92%)
INFO:ubt_solution.model:产品倾向性: 95/4096 样本有标签 (2.32%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05554218217730522
Training:  33%|███▎      | 1/3 [00:27<00:54, 27.41s/it]INFO:ubt_solution.trainer:Batch 1: 开始训练
INFO:ubt_solution.model:品类倾向性: 884/4096 样本有标签 (21.58%)
INFO:ubt_solution.model:产品倾向性: 114/4096 样本有标签 (2.78%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.055454399436712265
Training:  67%|██████▋   | 2/3 [00:28<00:11, 11.80s/it]INFO:ubt_solution.trainer:Batch 2: 开始训练
INFO:ubt_solution.model:品类倾向性: 415/1808 样本有标签 (22.95%)
INFO:ubt_solution.model:产品倾向性: 55/1808 样本有标签 (3.04%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05535009875893593
Training: 100%|██████████| 3/3 [00:28<00:00,  6.60s/it]Training: 100%|██████████| 3/3 [00:28<00:00,  9.61s/it]
INFO:ubt_solution.trainer:total_loss: 554.7149768471718, total_samples: 10000
INFO:ubt_solution.trainer:Epoch average loss: 0.0555
INFO:ubt_solution.trainer:训练集 category_propensity 标签比例: 21.56%
INFO:ubt_solution.trainer:训练集 product_propensity 标签比例: 2.64%
INFO:ubt_solution.trainer:Epoch average churn_loss: 0.0693
INFO:ubt_solution.trainer:Epoch average category_propensity_loss: 0.0309
INFO:ubt_solution.trainer:Epoch average product_propensity_loss: 0.0341
Validation:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.model:品类倾向性: 1185/4096 样本有标签 (28.93%)
INFO:ubt_solution.model:产品倾向性: 152/4096 样本有标签 (3.71%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  33%|███▎      | 1/3 [00:35<01:11, 35.82s/it]INFO:ubt_solution.model:品类倾向性: 707/4096 样本有标签 (17.26%)
INFO:ubt_solution.model:产品倾向性: 77/4096 样本有标签 (1.88%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  67%|██████▋   | 2/3 [00:36<00:14, 14.91s/it]INFO:ubt_solution.model:品类倾向性: 264/1808 样本有标签 (14.60%)
INFO:ubt_solution.model:产品倾向性: 35/1808 样本有标签 (1.94%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation: 100%|██████████| 3/3 [00:36<00:00,  8.16s/it]Validation: 100%|██████████| 3/3 [00:36<00:00, 12.14s/it]
INFO:ubt_solution.trainer:churn_loss improved: 0.0692
INFO:ubt_solution.trainer:category_propensity_loss improved: 0.0305
INFO:ubt_solution.trainer:product_propensity_loss improved: 0.0337
INFO:ubt_solution.trainer:New best churn_auc: 0.5721
INFO:ubt_solution.trainer:New best category_propensity_accuracy: 0.8810
INFO:ubt_solution.trainer:New best product_propensity_accuracy: 0.9164
INFO:ubt_solution.trainer:保存最佳模型，验证损失: 0.0553
INFO:ubt_solution.trainer:Validation metrics: {'val_loss': 0.05528376603722572, 'churn_loss': 0.06919568656682969, 'category_propensity_loss': 0.030500270634889602, 'product_propensity_loss': 0.033694187742471696, 'churn_auc': 0.5720945596694946, 'category_propensity_accuracy': 0.8809601068496704, 'category_propensity_pos_accuracy': 0.8809601068496704, 'product_propensity_accuracy': 0.9164015054702759, 'product_propensity_pos_accuracy': 0.9164015054702759}
INFO:ubt_solution.trainer:category_propensity 标签比例: 当前=21.56%, 平均=21.56%
INFO:ubt_solution.trainer:product_propensity 标签比例: 当前=2.64%, 平均=2.64%
INFO:ubt_solution.trainer:Epoch 2/15
Training:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.trainer:Batch 0: 开始训练
INFO:ubt_solution.trainer:Batch 0: 品类倾向性标签比例 = 21.58%
INFO:ubt_solution.trainer:Batch 0: 产品倾向性标签比例 = 2.59%
INFO:ubt_solution.model:品类倾向性: 884/4096 样本有标签 (21.58%)
INFO:ubt_solution.model:产品倾向性: 106/4096 样本有标签 (2.59%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.055343545973300934
Training:  33%|███▎      | 1/3 [00:26<00:53, 26.90s/it]INFO:ubt_solution.trainer:Batch 1: 开始训练
INFO:ubt_solution.model:品类倾向性: 888/4096 样本有标签 (21.68%)
INFO:ubt_solution.model:产品倾向性: 105/4096 样本有标签 (2.56%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.0552927702665329
Training:  67%|██████▋   | 2/3 [00:27<00:11, 11.59s/it]INFO:ubt_solution.trainer:Batch 2: 开始训练
INFO:ubt_solution.model:品类倾向性: 384/1808 样本有标签 (21.24%)
INFO:ubt_solution.model:产品倾向性: 53/1808 样本有标签 (2.93%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.055234383791685104
Training: 100%|██████████| 3/3 [00:28<00:00,  6.49s/it]Training: 100%|██████████| 3/3 [00:28<00:00,  9.45s/it]
INFO:ubt_solution.trainer:total_loss: 553.030117213726, total_samples: 10000
INFO:ubt_solution.trainer:Epoch average loss: 0.0553
INFO:ubt_solution.trainer:训练集 category_propensity 标签比例: 21.56%
INFO:ubt_solution.trainer:训练集 product_propensity 标签比例: 2.64%
INFO:ubt_solution.trainer:Epoch average churn_loss: 0.0692
INFO:ubt_solution.trainer:Epoch average category_propensity_loss: 0.0305
INFO:ubt_solution.trainer:Epoch average product_propensity_loss: 0.0337
Validation:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.model:品类倾向性: 1185/4096 样本有标签 (28.93%)
INFO:ubt_solution.model:产品倾向性: 152/4096 样本有标签 (3.71%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  33%|███▎      | 1/3 [00:49<01:38, 49.26s/it]INFO:ubt_solution.model:品类倾向性: 707/4096 样本有标签 (17.26%)
INFO:ubt_solution.model:产品倾向性: 77/4096 样本有标签 (1.88%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  67%|██████▋   | 2/3 [00:49<00:20, 20.45s/it]INFO:ubt_solution.model:品类倾向性: 264/1808 样本有标签 (14.60%)
INFO:ubt_solution.model:产品倾向性: 35/1808 样本有标签 (1.94%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation: 100%|██████████| 3/3 [00:49<00:00, 11.17s/it]Validation: 100%|██████████| 3/3 [00:49<00:00, 16.61s/it]
INFO:ubt_solution.trainer:churn_loss improved: 0.0691
INFO:ubt_solution.trainer:category_propensity_loss improved: 0.0300
INFO:ubt_solution.trainer:product_propensity_loss improved: 0.0332
INFO:ubt_solution.trainer:New best churn_auc: 0.5881
INFO:ubt_solution.trainer:New best category_propensity_accuracy: 0.9768
INFO:ubt_solution.trainer:New best product_propensity_accuracy: 0.9858
INFO:ubt_solution.trainer:保存最佳模型，验证损失: 0.0551
INFO:ubt_solution.trainer:Validation metrics: {'val_loss': 0.055068717539310454, 'churn_loss': 0.06914841315746308, 'category_propensity_loss': 0.030033891835808756, 'product_propensity_loss': 0.03317122370004654, 'churn_auc': 0.5881255865097046, 'category_propensity_accuracy': 0.9767578840255737, 'category_propensity_pos_accuracy': 0.9767578840255737, 'product_propensity_accuracy': 0.98575758934021, 'product_propensity_pos_accuracy': 0.98575758934021}
INFO:ubt_solution.trainer:category_propensity 标签比例: 当前=21.56%, 平均=21.56%
INFO:ubt_solution.trainer:product_propensity 标签比例: 当前=2.64%, 平均=2.64%
INFO:ubt_solution.trainer:Epoch 3/15
Training:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.trainer:Batch 0: 开始训练
INFO:ubt_solution.trainer:Batch 0: 品类倾向性标签比例 = 20.92%
INFO:ubt_solution.trainer:Batch 0: 产品倾向性标签比例 = 2.49%
INFO:ubt_solution.model:品类倾向性: 857/4096 样本有标签 (20.92%)
INFO:ubt_solution.model:产品倾向性: 102/4096 样本有标签 (2.49%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05519180744886398
Training:  33%|███▎      | 1/3 [00:26<00:53, 26.90s/it]INFO:ubt_solution.trainer:Batch 1: 开始训练
INFO:ubt_solution.model:品类倾向性: 895/4096 样本有标签 (21.85%)
INFO:ubt_solution.model:产品倾向性: 109/4096 样本有标签 (2.66%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05512189120054245
Training:  67%|██████▋   | 2/3 [00:27<00:11, 11.58s/it]INFO:ubt_solution.trainer:Batch 2: 开始训练
INFO:ubt_solution.model:品类倾向性: 404/1808 样本有标签 (22.35%)
INFO:ubt_solution.model:产品倾向性: 53/1808 样本有标签 (2.93%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05501711741089821
Training: 100%|██████████| 3/3 [00:28<00:00,  6.48s/it]Training: 100%|██████████| 3/3 [00:28<00:00,  9.44s/it]
INFO:ubt_solution.trainer:total_loss: 551.3158579468727, total_samples: 10000
INFO:ubt_solution.trainer:Epoch average loss: 0.0551
INFO:ubt_solution.trainer:训练集 category_propensity 标签比例: 21.56%
INFO:ubt_solution.trainer:训练集 product_propensity 标签比例: 2.64%
INFO:ubt_solution.trainer:Epoch average churn_loss: 0.0692
INFO:ubt_solution.trainer:Epoch average category_propensity_loss: 0.0301
INFO:ubt_solution.trainer:Epoch average product_propensity_loss: 0.0333
Validation:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.model:品类倾向性: 1185/4096 样本有标签 (28.93%)
INFO:ubt_solution.model:产品倾向性: 152/4096 样本有标签 (3.71%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  33%|███▎      | 1/3 [00:33<01:07, 33.51s/it]INFO:ubt_solution.model:品类倾向性: 707/4096 样本有标签 (17.26%)
INFO:ubt_solution.model:产品倾向性: 77/4096 样本有标签 (1.88%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  67%|██████▋   | 2/3 [00:33<00:13, 13.96s/it]INFO:ubt_solution.model:品类倾向性: 264/1808 样本有标签 (14.60%)
INFO:ubt_solution.model:产品倾向性: 35/1808 样本有标签 (1.94%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation: 100%|██████████| 3/3 [00:33<00:00,  7.64s/it]Validation: 100%|██████████| 3/3 [00:34<00:00, 11.36s/it]
INFO:ubt_solution.trainer:churn_loss improved: 0.0691
INFO:ubt_solution.trainer:category_propensity_loss improved: 0.0296
INFO:ubt_solution.trainer:product_propensity_loss improved: 0.0327
INFO:ubt_solution.trainer:New best churn_auc: 0.5969
INFO:ubt_solution.trainer:New best category_propensity_accuracy: 0.9866
INFO:ubt_solution.trainer:New best product_propensity_accuracy: 0.9862
INFO:ubt_solution.trainer:保存最佳模型，验证损失: 0.0549
INFO:ubt_solution.trainer:Validation metrics: {'val_loss': 0.0548582994222641, 'churn_loss': 0.06910576041936875, 'category_propensity_loss': 0.029573024201393128, 'product_propensity_loss': 0.0326520307302475, 'churn_auc': 0.5968960523605347, 'category_propensity_accuracy': 0.9865862727165222, 'category_propensity_pos_accuracy': 0.9865862727165222, 'product_propensity_accuracy': 0.9862499833106995, 'product_propensity_pos_accuracy': 0.9862499833106995}
INFO:ubt_solution.trainer:category_propensity 标签比例: 当前=21.56%, 平均=21.56%
INFO:ubt_solution.trainer:product_propensity 标签比例: 当前=2.64%, 平均=2.64%
INFO:ubt_solution.trainer:Epoch 4/15
Training:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.trainer:Batch 0: 开始训练
INFO:ubt_solution.trainer:Batch 0: 品类倾向性标签比例 = 21.36%
INFO:ubt_solution.trainer:Batch 0: 产品倾向性标签比例 = 2.83%
INFO:ubt_solution.model:品类倾向性: 875/4096 样本有标签 (21.36%)
INFO:ubt_solution.model:产品倾向性: 116/4096 样本有标签 (2.83%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.055014822632074356
Training:  33%|███▎      | 1/3 [00:27<00:54, 27.41s/it]INFO:ubt_solution.trainer:Batch 1: 开始训练
INFO:ubt_solution.model:品类倾向性: 910/4096 样本有标签 (22.22%)
INFO:ubt_solution.model:产品倾向性: 108/4096 样本有标签 (2.64%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.054950036108493805
Training:  67%|██████▋   | 2/3 [00:36<00:16, 16.63s/it]INFO:ubt_solution.trainer:Batch 2: 开始训练
INFO:ubt_solution.model:品类倾向性: 371/1808 样本有标签 (20.52%)
INFO:ubt_solution.model:产品倾向性: 40/1808 样本有标签 (2.21%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.054891519248485565
Training: 100%|██████████| 3/3 [00:36<00:00,  9.22s/it]Training: 100%|██████████| 3/3 [00:37<00:00, 12.35s/it]
INFO:ubt_solution.trainer:total_loss: 549.6599282026291, total_samples: 10000
INFO:ubt_solution.trainer:Epoch average loss: 0.0550
INFO:ubt_solution.trainer:训练集 category_propensity 标签比例: 21.56%
INFO:ubt_solution.trainer:训练集 product_propensity 标签比例: 2.64%
INFO:ubt_solution.trainer:Epoch average churn_loss: 0.0692
INFO:ubt_solution.trainer:Epoch average category_propensity_loss: 0.0298
INFO:ubt_solution.trainer:Epoch average product_propensity_loss: 0.0329
Validation:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.model:品类倾向性: 1185/4096 样本有标签 (28.93%)
INFO:ubt_solution.model:产品倾向性: 152/4096 样本有标签 (3.71%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  33%|███▎      | 1/3 [00:33<01:07, 33.80s/it]INFO:ubt_solution.model:品类倾向性: 707/4096 样本有标签 (17.26%)
INFO:ubt_solution.model:产品倾向性: 77/4096 样本有标签 (1.88%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  67%|██████▋   | 2/3 [00:34<00:14, 14.08s/it]INFO:ubt_solution.model:品类倾向性: 264/1808 样本有标签 (14.60%)
INFO:ubt_solution.model:产品倾向性: 35/1808 样本有标签 (1.94%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation: 100%|██████████| 3/3 [00:34<00:00,  7.71s/it]Validation: 100%|██████████| 3/3 [00:34<00:00, 11.45s/it]
INFO:ubt_solution.trainer:churn_loss improved: 0.0691
INFO:ubt_solution.trainer:category_propensity_loss improved: 0.0291
INFO:ubt_solution.trainer:product_propensity_loss improved: 0.0321
INFO:ubt_solution.trainer:New best churn_auc: 0.5974
INFO:ubt_solution.trainer:保存最佳模型，验证损失: 0.0547
INFO:ubt_solution.trainer:Validation metrics: {'val_loss': 0.05465004251599312, 'churn_loss': 0.0690664534330368, 'category_propensity_loss': 0.029115806275606157, 'product_propensity_loss': 0.03212957473993301, 'churn_auc': 0.5974268317222595, 'category_propensity_accuracy': 0.9865862727165222, 'category_propensity_pos_accuracy': 0.9865862727165222, 'product_propensity_accuracy': 0.9862499833106995, 'product_propensity_pos_accuracy': 0.9862499833106995}
INFO:ubt_solution.trainer:category_propensity 标签比例: 当前=21.56%, 平均=21.56%
INFO:ubt_solution.trainer:product_propensity 标签比例: 当前=2.64%, 平均=2.64%
INFO:ubt_solution.trainer:Epoch 5/15
Training:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.trainer:Batch 0: 开始训练
INFO:ubt_solution.trainer:Batch 0: 品类倾向性标签比例 = 20.46%
INFO:ubt_solution.trainer:Batch 0: 产品倾向性标签比例 = 2.69%
INFO:ubt_solution.model:品类倾向性: 838/4096 样本有标签 (20.46%)
INFO:ubt_solution.model:产品倾向性: 110/4096 样本有标签 (2.69%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.054878488183021545
Training:  33%|███▎      | 1/3 [00:37<01:14, 37.25s/it]INFO:ubt_solution.trainer:Batch 1: 开始训练
INFO:ubt_solution.model:品类倾向性: 924/4096 样本有标签 (22.56%)
INFO:ubt_solution.model:产品倾向性: 108/4096 样本有标签 (2.64%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05473930761218071
Training:  67%|██████▋   | 2/3 [00:38<00:15, 15.85s/it]INFO:ubt_solution.trainer:Batch 2: 开始训练
INFO:ubt_solution.model:品类倾向性: 394/1808 样本有标签 (21.79%)
INFO:ubt_solution.model:产品倾向性: 46/1808 样本有标签 (2.54%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05469847470521927
Training: 100%|██████████| 3/3 [00:38<00:00,  8.79s/it]Training: 100%|██████████| 3/3 [00:38<00:00, 12.89s/it]
INFO:ubt_solution.trainer:total_loss: 547.8893338441849, total_samples: 10000
INFO:ubt_solution.trainer:Epoch average loss: 0.0548
INFO:ubt_solution.trainer:训练集 category_propensity 标签比例: 21.56%
INFO:ubt_solution.trainer:训练集 product_propensity 标签比例: 2.64%
INFO:ubt_solution.trainer:Epoch average churn_loss: 0.0691
INFO:ubt_solution.trainer:Epoch average category_propensity_loss: 0.0294
INFO:ubt_solution.trainer:Epoch average product_propensity_loss: 0.0324
Validation:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.model:品类倾向性: 1185/4096 样本有标签 (28.93%)
INFO:ubt_solution.model:产品倾向性: 152/4096 样本有标签 (3.71%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  33%|███▎      | 1/3 [00:34<01:08, 34.02s/it]INFO:ubt_solution.model:品类倾向性: 707/4096 样本有标签 (17.26%)
INFO:ubt_solution.model:产品倾向性: 77/4096 样本有标签 (1.88%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  67%|██████▋   | 2/3 [00:34<00:14, 14.17s/it]INFO:ubt_solution.model:品类倾向性: 264/1808 样本有标签 (14.60%)
INFO:ubt_solution.model:产品倾向性: 35/1808 样本有标签 (1.94%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation: 100%|██████████| 3/3 [00:34<00:00,  7.76s/it]Validation: 100%|██████████| 3/3 [00:34<00:00, 11.53s/it]
INFO:ubt_solution.trainer:churn_loss improved: 0.0690
INFO:ubt_solution.trainer:category_propensity_loss improved: 0.0287
INFO:ubt_solution.trainer:product_propensity_loss improved: 0.0316
INFO:ubt_solution.trainer:保存最佳模型，验证损失: 0.0544
INFO:ubt_solution.trainer:Validation metrics: {'val_loss': 0.05444141344428063, 'churn_loss': 0.0690289882183075, 'category_propensity_loss': 0.028655342516303063, 'product_propensity_loss': 0.03160222470760345, 'churn_auc': 0.5932146310806274, 'category_propensity_accuracy': 0.9865862727165222, 'category_propensity_pos_accuracy': 0.9865862727165222, 'product_propensity_accuracy': 0.9862499833106995, 'product_propensity_pos_accuracy': 0.9862499833106995}
INFO:ubt_solution.trainer:category_propensity 标签比例: 当前=21.56%, 平均=21.56%
INFO:ubt_solution.trainer:product_propensity 标签比例: 当前=2.64%, 平均=2.64%
INFO:ubt_solution.trainer:Epoch 6/15
Training:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.trainer:Batch 0: 开始训练
INFO:ubt_solution.trainer:Batch 0: 品类倾向性标签比例 = 21.41%
INFO:ubt_solution.trainer:Batch 0: 产品倾向性标签比例 = 2.37%
INFO:ubt_solution.model:品类倾向性: 877/4096 样本有标签 (21.41%)
INFO:ubt_solution.model:产品倾向性: 97/4096 样本有标签 (2.37%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.054660387337207794
Training:  33%|███▎      | 1/3 [00:37<01:14, 37.17s/it]INFO:ubt_solution.trainer:Batch 1: 开始训练
INFO:ubt_solution.model:品类倾向性: 876/4096 样本有标签 (21.39%)
INFO:ubt_solution.model:产品倾向性: 109/4096 样本有标签 (2.66%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05460135638713837
Training:  67%|██████▋   | 2/3 [00:38<00:15, 15.83s/it]INFO:ubt_solution.trainer:Batch 2: 开始训练
INFO:ubt_solution.model:品类倾向性: 403/1808 样本有标签 (22.29%)
INFO:ubt_solution.model:产品倾向性: 58/1808 样本有标签 (3.21%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05453264340758324
Training: 100%|██████████| 3/3 [00:38<00:00,  8.79s/it]Training: 100%|██████████| 3/3 [00:38<00:00, 12.88s/it]
INFO:ubt_solution.trainer:total_loss: 546.1311215758324, total_samples: 10000
INFO:ubt_solution.trainer:Epoch average loss: 0.0546
INFO:ubt_solution.trainer:训练集 category_propensity 标签比例: 21.56%
INFO:ubt_solution.trainer:训练集 product_propensity 标签比例: 2.64%
INFO:ubt_solution.trainer:Epoch average churn_loss: 0.0691
INFO:ubt_solution.trainer:Epoch average category_propensity_loss: 0.0290
INFO:ubt_solution.trainer:Epoch average product_propensity_loss: 0.0320
Validation:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.model:品类倾向性: 1185/4096 样本有标签 (28.93%)
INFO:ubt_solution.model:产品倾向性: 152/4096 样本有标签 (3.71%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  33%|███▎      | 1/3 [00:33<01:07, 33.54s/it]INFO:ubt_solution.model:品类倾向性: 707/4096 样本有标签 (17.26%)
INFO:ubt_solution.model:产品倾向性: 77/4096 样本有标签 (1.88%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  67%|██████▋   | 2/3 [00:33<00:13, 13.97s/it]INFO:ubt_solution.model:品类倾向性: 264/1808 样本有标签 (14.60%)
INFO:ubt_solution.model:产品倾向性: 35/1808 样本有标签 (1.94%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation: 100%|██████████| 3/3 [00:33<00:00,  7.65s/it]Validation: 100%|██████████| 3/3 [00:34<00:00, 11.36s/it]
INFO:ubt_solution.trainer:churn_loss improved: 0.0690
INFO:ubt_solution.trainer:category_propensity_loss improved: 0.0282
INFO:ubt_solution.trainer:product_propensity_loss improved: 0.0311
INFO:ubt_solution.trainer:保存最佳模型，验证损失: 0.0542
INFO:ubt_solution.trainer:Validation metrics: {'val_loss': 0.05423056493401528, 'churn_loss': 0.06899273504018784, 'category_propensity_loss': 0.02818861496448517, 'product_propensity_loss': 0.03106528211236, 'churn_auc': 0.5913403034210205, 'category_propensity_accuracy': 0.9865862727165222, 'category_propensity_pos_accuracy': 0.9865862727165222, 'product_propensity_accuracy': 0.9862499833106995, 'product_propensity_pos_accuracy': 0.9862499833106995}
INFO:ubt_solution.trainer:category_propensity 标签比例: 当前=21.56%, 平均=21.56%
INFO:ubt_solution.trainer:product_propensity 标签比例: 当前=2.64%, 平均=2.64%
INFO:ubt_solution.trainer:Epoch 7/15
Training:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.trainer:Batch 0: 开始训练
INFO:ubt_solution.trainer:Batch 0: 品类倾向性标签比例 = 22.29%
INFO:ubt_solution.trainer:Batch 0: 产品倾向性标签比例 = 2.49%
INFO:ubt_solution.model:品类倾向性: 913/4096 样本有标签 (22.29%)
INFO:ubt_solution.model:产品倾向性: 102/4096 样本有标签 (2.49%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05448510870337486
Training:  33%|███▎      | 1/3 [00:27<00:55, 27.67s/it]INFO:ubt_solution.trainer:Batch 1: 开始训练
INFO:ubt_solution.model:品类倾向性: 865/4096 样本有标签 (21.12%)
INFO:ubt_solution.model:产品倾向性: 106/4096 样本有标签 (2.59%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05441669374704361
Training:  67%|██████▋   | 2/3 [00:28<00:11, 11.90s/it]INFO:ubt_solution.trainer:Batch 2: 开始训练
INFO:ubt_solution.model:品类倾向性: 378/1808 样本有标签 (20.91%)
INFO:ubt_solution.model:产品倾向性: 56/1808 样本有标签 (3.10%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05440163612365723
Training: 100%|██████████| 3/3 [00:28<00:00,  6.65s/it]Training: 100%|██████████| 3/3 [00:29<00:00,  9.71s/it]
INFO:ubt_solution.trainer:total_loss: 544.4199409484863, total_samples: 10000
INFO:ubt_solution.trainer:Epoch average loss: 0.0544
INFO:ubt_solution.trainer:训练集 category_propensity 标签比例: 21.56%
INFO:ubt_solution.trainer:训练集 product_propensity 标签比例: 2.64%
INFO:ubt_solution.trainer:Epoch average churn_loss: 0.0691
INFO:ubt_solution.trainer:Epoch average category_propensity_loss: 0.0286
INFO:ubt_solution.trainer:Epoch average product_propensity_loss: 0.0315
Validation:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.model:品类倾向性: 1185/4096 样本有标签 (28.93%)
INFO:ubt_solution.model:产品倾向性: 152/4096 样本有标签 (3.71%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  33%|███▎      | 1/3 [00:33<01:07, 33.66s/it]INFO:ubt_solution.model:品类倾向性: 707/4096 样本有标签 (17.26%)
INFO:ubt_solution.model:产品倾向性: 77/4096 样本有标签 (1.88%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  67%|██████▋   | 2/3 [00:33<00:14, 14.02s/it]INFO:ubt_solution.model:品类倾向性: 264/1808 样本有标签 (14.60%)
INFO:ubt_solution.model:产品倾向性: 35/1808 样本有标签 (1.94%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation: 100%|██████████| 3/3 [00:34<00:00,  7.68s/it]Validation: 100%|██████████| 3/3 [00:34<00:00, 11.41s/it]
INFO:ubt_solution.trainer:churn_loss improved: 0.0690
INFO:ubt_solution.trainer:category_propensity_loss improved: 0.0277
INFO:ubt_solution.trainer:product_propensity_loss improved: 0.0305
INFO:ubt_solution.trainer:保存最佳模型，验证损失: 0.0540
INFO:ubt_solution.trainer:Validation metrics: {'val_loss': 0.0540175916492939, 'churn_loss': 0.06895847597122193, 'category_propensity_loss': 0.02771593759059906, 'product_propensity_loss': 0.030516297617554665, 'churn_auc': 0.5910534858703613, 'category_propensity_accuracy': 0.9865862727165222, 'category_propensity_pos_accuracy': 0.9865862727165222, 'product_propensity_accuracy': 0.9862499833106995, 'product_propensity_pos_accuracy': 0.9862499833106995}
INFO:ubt_solution.trainer:category_propensity 标签比例: 当前=21.56%, 平均=21.56%
INFO:ubt_solution.trainer:product_propensity 标签比例: 当前=2.64%, 平均=2.64%
INFO:ubt_solution.trainer:Epoch 8/15
Training:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.trainer:Batch 0: 开始训练
INFO:ubt_solution.trainer:Batch 0: 品类倾向性标签比例 = 21.34%
INFO:ubt_solution.trainer:Batch 0: 产品倾向性标签比例 = 2.91%
INFO:ubt_solution.model:品类倾向性: 874/4096 样本有标签 (21.34%)
INFO:ubt_solution.model:产品倾向性: 119/4096 样本有标签 (2.91%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.0542912632226944
Training:  33%|███▎      | 1/3 [00:26<00:53, 26.88s/it]INFO:ubt_solution.trainer:Batch 1: 开始训练
INFO:ubt_solution.model:品类倾向性: 907/4096 样本有标签 (22.14%)
INFO:ubt_solution.model:产品倾向性: 101/4096 样本有标签 (2.47%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.054243773221969604
Training:  67%|██████▋   | 2/3 [00:27<00:11, 11.58s/it]INFO:ubt_solution.trainer:Batch 2: 开始训练
INFO:ubt_solution.model:品类倾向性: 375/1808 样本有标签 (20.74%)
INFO:ubt_solution.model:产品倾向性: 44/1808 样本有标签 (2.43%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05424528196454048
Training: 100%|██████████| 3/3 [00:28<00:00,  6.48s/it]Training: 100%|██████████| 3/3 [00:28<00:00,  9.43s/it]
INFO:ubt_solution.trainer:total_loss: 542.6349790692329, total_samples: 10000
INFO:ubt_solution.trainer:Epoch average loss: 0.0543
INFO:ubt_solution.trainer:训练集 category_propensity 标签比例: 21.56%
INFO:ubt_solution.trainer:训练集 product_propensity 标签比例: 2.64%
INFO:ubt_solution.trainer:Epoch average churn_loss: 0.0690
INFO:ubt_solution.trainer:Epoch average category_propensity_loss: 0.0282
INFO:ubt_solution.trainer:Epoch average product_propensity_loss: 0.0311
Validation:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.model:品类倾向性: 1185/4096 样本有标签 (28.93%)
INFO:ubt_solution.model:产品倾向性: 152/4096 样本有标签 (3.71%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  33%|███▎      | 1/3 [00:34<01:08, 34.05s/it]INFO:ubt_solution.model:品类倾向性: 707/4096 样本有标签 (17.26%)
INFO:ubt_solution.model:产品倾向性: 77/4096 样本有标签 (1.88%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  67%|██████▋   | 2/3 [00:34<00:14, 14.18s/it]INFO:ubt_solution.model:品类倾向性: 264/1808 样本有标签 (14.60%)
INFO:ubt_solution.model:产品倾向性: 35/1808 样本有标签 (1.94%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation: 100%|██████████| 3/3 [00:34<00:00,  7.76s/it]Validation: 100%|██████████| 3/3 [00:34<00:00, 11.54s/it]
INFO:ubt_solution.trainer:churn_loss improved: 0.0689
INFO:ubt_solution.trainer:category_propensity_loss improved: 0.0272
INFO:ubt_solution.trainer:product_propensity_loss improved: 0.0300
INFO:ubt_solution.trainer:保存最佳模型，验证损失: 0.0538
INFO:ubt_solution.trainer:Validation metrics: {'val_loss': 0.05380190393924713, 'churn_loss': 0.06892503770589828, 'category_propensity_loss': 0.027236272525787353, 'product_propensity_loss': 0.029957079172134398, 'churn_auc': 0.5925727486610413, 'category_propensity_accuracy': 0.9865862727165222, 'category_propensity_pos_accuracy': 0.9865862727165222, 'product_propensity_accuracy': 0.9862499833106995, 'product_propensity_pos_accuracy': 0.9862499833106995}
INFO:ubt_solution.trainer:category_propensity 标签比例: 当前=21.56%, 平均=21.56%
INFO:ubt_solution.trainer:product_propensity 标签比例: 当前=2.64%, 平均=2.64%
INFO:ubt_solution.trainer:Epoch 9/15
Training:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.trainer:Batch 0: 开始训练
INFO:ubt_solution.trainer:Batch 0: 品类倾向性标签比例 = 21.68%
INFO:ubt_solution.trainer:Batch 0: 产品倾向性标签比例 = 2.56%
INFO:ubt_solution.model:品类倾向性: 888/4096 样本有标签 (21.68%)
INFO:ubt_solution.model:产品倾向性: 105/4096 样本有标签 (2.56%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05415566265583038
Training:  33%|███▎      | 1/3 [00:27<00:54, 27.08s/it]INFO:ubt_solution.trainer:Batch 1: 开始训练
INFO:ubt_solution.model:品类倾向性: 864/4096 样本有标签 (21.09%)
INFO:ubt_solution.model:产品倾向性: 104/4096 样本有标签 (2.54%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05405617132782936
Training:  67%|██████▋   | 2/3 [00:27<00:11, 11.66s/it]INFO:ubt_solution.trainer:Batch 2: 开始训练
INFO:ubt_solution.model:品类倾向性: 404/1808 样本有标签 (22.35%)
INFO:ubt_solution.model:产品倾向性: 55/1808 样本有标签 (3.04%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.053980812430381775
Training: 100%|██████████| 3/3 [00:28<00:00,  6.52s/it]Training: 100%|██████████| 3/3 [00:28<00:00,  9.50s/it]
INFO:ubt_solution.trainer:total_loss: 540.8329808712006, total_samples: 10000
INFO:ubt_solution.trainer:Epoch average loss: 0.0541
INFO:ubt_solution.trainer:训练集 category_propensity 标签比例: 21.56%
INFO:ubt_solution.trainer:训练集 product_propensity 标签比例: 2.64%
INFO:ubt_solution.trainer:Epoch average churn_loss: 0.0690
INFO:ubt_solution.trainer:Epoch average category_propensity_loss: 0.0278
INFO:ubt_solution.trainer:Epoch average product_propensity_loss: 0.0306
Validation:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.model:品类倾向性: 1185/4096 样本有标签 (28.93%)
INFO:ubt_solution.model:产品倾向性: 152/4096 样本有标签 (3.71%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  33%|███▎      | 1/3 [00:33<01:07, 33.62s/it]INFO:ubt_solution.model:品类倾向性: 707/4096 样本有标签 (17.26%)
INFO:ubt_solution.model:产品倾向性: 77/4096 样本有标签 (1.88%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  67%|██████▋   | 2/3 [00:33<00:14, 14.01s/it]INFO:ubt_solution.model:品类倾向性: 264/1808 样本有标签 (14.60%)
INFO:ubt_solution.model:产品倾向性: 35/1808 样本有标签 (1.94%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation: 100%|██████████| 3/3 [00:34<00:00,  7.67s/it]Validation: 100%|██████████| 3/3 [00:34<00:00, 11.41s/it]
INFO:ubt_solution.trainer:churn_loss improved: 0.0689
INFO:ubt_solution.trainer:category_propensity_loss improved: 0.0267
INFO:ubt_solution.trainer:product_propensity_loss improved: 0.0294
INFO:ubt_solution.trainer:保存最佳模型，验证损失: 0.0536
INFO:ubt_solution.trainer:Validation metrics: {'val_loss': 0.05358398729562759, 'churn_loss': 0.06889307880401611, 'category_propensity_loss': 0.02674890292584896, 'product_propensity_loss': 0.029388767033815384, 'churn_auc': 0.5958888530731201, 'category_propensity_accuracy': 0.9865862727165222, 'category_propensity_pos_accuracy': 0.9865862727165222, 'product_propensity_accuracy': 0.9862499833106995, 'product_propensity_pos_accuracy': 0.9862499833106995}
INFO:ubt_solution.trainer:category_propensity 标签比例: 当前=21.56%, 平均=21.56%
INFO:ubt_solution.trainer:product_propensity 标签比例: 当前=2.64%, 平均=2.64%
INFO:ubt_solution.trainer:Epoch 10/15
Training:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.trainer:Batch 0: 开始训练
INFO:ubt_solution.trainer:Batch 0: 品类倾向性标签比例 = 20.61%
INFO:ubt_solution.trainer:Batch 0: 产品倾向性标签比例 = 2.27%
INFO:ubt_solution.model:品类倾向性: 844/4096 样本有标签 (20.61%)
INFO:ubt_solution.model:产品倾向性: 93/4096 样本有标签 (2.27%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05395461246371269
Training:  33%|███▎      | 1/3 [00:27<00:54, 27.11s/it]INFO:ubt_solution.trainer:Batch 1: 开始训练
INFO:ubt_solution.model:品类倾向性: 911/4096 样本有标签 (22.24%)
INFO:ubt_solution.model:产品倾向性: 118/4096 样本有标签 (2.88%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05390167981386185
Training:  67%|██████▋   | 2/3 [00:27<00:11, 11.67s/it]INFO:ubt_solution.trainer:Batch 2: 开始训练
INFO:ubt_solution.model:品类倾向性: 401/1808 样本有标签 (22.18%)
INFO:ubt_solution.model:产品倾向性: 53/1808 样本有标签 (2.93%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05378814786672592
Training: 100%|██████████| 3/3 [00:28<00:00,  6.53s/it]Training: 100%|██████████| 3/3 [00:28<00:00,  9.51s/it]
INFO:ubt_solution.trainer:total_loss: 539.0283445119858, total_samples: 10000
INFO:ubt_solution.trainer:Epoch average loss: 0.0539
INFO:ubt_solution.trainer:训练集 category_propensity 标签比例: 21.56%
INFO:ubt_solution.trainer:训练集 product_propensity 标签比例: 2.64%
INFO:ubt_solution.trainer:Epoch average churn_loss: 0.0690
INFO:ubt_solution.trainer:Epoch average category_propensity_loss: 0.0274
INFO:ubt_solution.trainer:Epoch average product_propensity_loss: 0.0301
Validation:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.model:品类倾向性: 1185/4096 样本有标签 (28.93%)
INFO:ubt_solution.model:产品倾向性: 152/4096 样本有标签 (3.71%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  33%|███▎      | 1/3 [00:34<01:08, 34.39s/it]INFO:ubt_solution.model:品类倾向性: 707/4096 样本有标签 (17.26%)
INFO:ubt_solution.model:产品倾向性: 77/4096 样本有标签 (1.88%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  67%|██████▋   | 2/3 [00:34<00:14, 14.34s/it]INFO:ubt_solution.model:品类倾向性: 264/1808 样本有标签 (14.60%)
INFO:ubt_solution.model:产品倾向性: 35/1808 样本有标签 (1.94%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation: 100%|██████████| 3/3 [00:34<00:00,  7.86s/it]Validation: 100%|██████████| 3/3 [00:35<00:00, 11.67s/it]
INFO:ubt_solution.trainer:churn_loss improved: 0.0689
INFO:ubt_solution.trainer:category_propensity_loss improved: 0.0263
INFO:ubt_solution.trainer:product_propensity_loss improved: 0.0288
INFO:ubt_solution.trainer:New best churn_auc: 0.5996
INFO:ubt_solution.trainer:保存最佳模型，验证损失: 0.0534
INFO:ubt_solution.trainer:Validation metrics: {'val_loss': 0.053363555705547336, 'churn_loss': 0.06886269750595093, 'category_propensity_loss': 0.026253173318505286, 'product_propensity_loss': 0.028810137686133386, 'churn_auc': 0.5995908975601196, 'category_propensity_accuracy': 0.9865862727165222, 'category_propensity_pos_accuracy': 0.9865862727165222, 'product_propensity_accuracy': 0.9862499833106995, 'product_propensity_pos_accuracy': 0.9862499833106995}
INFO:ubt_solution.trainer:category_propensity 标签比例: 当前=21.56%, 平均=21.56%
INFO:ubt_solution.trainer:product_propensity 标签比例: 当前=2.64%, 平均=2.64%
INFO:ubt_solution.trainer:Epoch 11/15
Training:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.trainer:Batch 0: 开始训练
INFO:ubt_solution.trainer:Batch 0: 品类倾向性标签比例 = 21.39%
INFO:ubt_solution.trainer:Batch 0: 产品倾向性标签比例 = 2.47%
INFO:ubt_solution.model:品类倾向性: 876/4096 样本有标签 (21.39%)
INFO:ubt_solution.model:产品倾向性: 101/4096 样本有标签 (2.47%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05373009666800499
Training:  33%|███▎      | 1/3 [00:27<00:55, 27.63s/it]INFO:ubt_solution.trainer:Batch 1: 开始训练
INFO:ubt_solution.model:品类倾向性: 909/4096 样本有标签 (22.19%)
INFO:ubt_solution.model:产品倾向性: 103/4096 样本有标签 (2.51%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05375886708498001
Training:  67%|██████▋   | 2/3 [00:37<00:17, 17.30s/it]INFO:ubt_solution.trainer:Batch 2: 开始训练
INFO:ubt_solution.model:品类倾向性: 371/1808 样本有标签 (20.52%)
INFO:ubt_solution.model:产品倾向性: 60/1808 样本有标签 (3.32%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05360020697116852
Training: 100%|██████████| 3/3 [00:38<00:00,  9.58s/it]Training: 100%|██████████| 3/3 [00:38<00:00, 12.77s/it]
INFO:ubt_solution.trainer:total_loss: 537.1839697360992, total_samples: 10000
INFO:ubt_solution.trainer:Epoch average loss: 0.0537
INFO:ubt_solution.trainer:训练集 category_propensity 标签比例: 21.56%
INFO:ubt_solution.trainer:训练集 product_propensity 标签比例: 2.64%
INFO:ubt_solution.trainer:Epoch average churn_loss: 0.0690
INFO:ubt_solution.trainer:Epoch average category_propensity_loss: 0.0270
INFO:ubt_solution.trainer:Epoch average product_propensity_loss: 0.0296
Validation:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.model:品类倾向性: 1185/4096 样本有标签 (28.93%)
INFO:ubt_solution.model:产品倾向性: 152/4096 样本有标签 (3.71%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  33%|███▎      | 1/3 [00:33<01:07, 33.82s/it]INFO:ubt_solution.model:品类倾向性: 707/4096 样本有标签 (17.26%)
INFO:ubt_solution.model:产品倾向性: 77/4096 样本有标签 (1.88%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  67%|██████▋   | 2/3 [00:34<00:14, 14.09s/it]INFO:ubt_solution.model:品类倾向性: 264/1808 样本有标签 (14.60%)
INFO:ubt_solution.model:产品倾向性: 35/1808 样本有标签 (1.94%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation: 100%|██████████| 3/3 [00:34<00:00,  7.71s/it]Validation: 100%|██████████| 3/3 [00:34<00:00, 11.47s/it]
INFO:ubt_solution.trainer:churn_loss improved: 0.0688
INFO:ubt_solution.trainer:category_propensity_loss improved: 0.0257
INFO:ubt_solution.trainer:product_propensity_loss improved: 0.0282
INFO:ubt_solution.trainer:New best churn_auc: 0.6022
INFO:ubt_solution.trainer:保存最佳模型，验证损失: 0.0531
INFO:ubt_solution.trainer:Validation metrics: {'val_loss': 0.05314083788394928, 'churn_loss': 0.06883451532125473, 'category_propensity_loss': 0.02574692514836788, 'product_propensity_loss': 0.028222479000687598, 'churn_auc': 0.6021904945373535, 'category_propensity_accuracy': 0.9865862727165222, 'category_propensity_pos_accuracy': 0.9865862727165222, 'product_propensity_accuracy': 0.9862499833106995, 'product_propensity_pos_accuracy': 0.9862499833106995}
INFO:ubt_solution.trainer:category_propensity 标签比例: 当前=21.56%, 平均=21.56%
INFO:ubt_solution.trainer:product_propensity 标签比例: 当前=2.64%, 平均=2.64%
INFO:ubt_solution.trainer:Epoch 12/15
Training:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.trainer:Batch 0: 开始训练
INFO:ubt_solution.trainer:Batch 0: 品类倾向性标签比例 = 21.34%
INFO:ubt_solution.trainer:Batch 0: 产品倾向性标签比例 = 2.64%
INFO:ubt_solution.model:品类倾向性: 874/4096 样本有标签 (21.34%)
INFO:ubt_solution.model:产品倾向性: 108/4096 样本有标签 (2.64%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05355625972151756
Training:  33%|███▎      | 1/3 [00:26<00:53, 26.90s/it]INFO:ubt_solution.trainer:Batch 1: 开始训练
INFO:ubt_solution.model:品类倾向性: 875/4096 样本有标签 (21.36%)
INFO:ubt_solution.model:产品倾向性: 115/4096 样本有标签 (2.81%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05352773144841194
Training:  67%|██████▋   | 2/3 [00:27<00:11, 11.59s/it]INFO:ubt_solution.trainer:Batch 2: 开始训练
INFO:ubt_solution.model:品类倾向性: 407/1808 样本有标签 (22.51%)
INFO:ubt_solution.model:产品倾向性: 41/1808 样本有标签 (2.27%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.053477562963962555
Training: 100%|██████████| 3/3 [00:28<00:00,  6.48s/it]Training: 100%|██████████| 3/3 [00:28<00:00,  9.44s/it]
INFO:ubt_solution.trainer:total_loss: 535.3034616708755, total_samples: 10000
INFO:ubt_solution.trainer:Epoch average loss: 0.0535
INFO:ubt_solution.trainer:训练集 category_propensity 标签比例: 21.56%
INFO:ubt_solution.trainer:训练集 product_propensity 标签比例: 2.64%
INFO:ubt_solution.trainer:Epoch average churn_loss: 0.0689
INFO:ubt_solution.trainer:Epoch average category_propensity_loss: 0.0266
INFO:ubt_solution.trainer:Epoch average product_propensity_loss: 0.0292
Validation:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.model:品类倾向性: 1185/4096 样本有标签 (28.93%)
INFO:ubt_solution.model:产品倾向性: 152/4096 样本有标签 (3.71%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  33%|███▎      | 1/3 [00:33<01:07, 33.50s/it]INFO:ubt_solution.model:品类倾向性: 707/4096 样本有标签 (17.26%)
INFO:ubt_solution.model:产品倾向性: 77/4096 样本有标签 (1.88%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  67%|██████▋   | 2/3 [00:33<00:13, 13.96s/it]INFO:ubt_solution.model:品类倾向性: 264/1808 样本有标签 (14.60%)
INFO:ubt_solution.model:产品倾向性: 35/1808 样本有标签 (1.94%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation: 100%|██████████| 3/3 [00:33<00:00,  7.64s/it]Validation: 100%|██████████| 3/3 [00:34<00:00, 11.36s/it]
INFO:ubt_solution.trainer:churn_loss improved: 0.0688
INFO:ubt_solution.trainer:category_propensity_loss improved: 0.0252
INFO:ubt_solution.trainer:product_propensity_loss improved: 0.0276
INFO:ubt_solution.trainer:New best churn_auc: 0.6042
INFO:ubt_solution.trainer:保存最佳模型，验证损失: 0.0529
INFO:ubt_solution.trainer:Validation metrics: {'val_loss': 0.0529158140361309, 'churn_loss': 0.06880829356908798, 'category_propensity_loss': 0.025227663800120353, 'product_propensity_loss': 0.02762903845012188, 'churn_auc': 0.6042075157165527, 'category_propensity_accuracy': 0.9865862727165222, 'category_propensity_pos_accuracy': 0.9865862727165222, 'product_propensity_accuracy': 0.9862499833106995, 'product_propensity_pos_accuracy': 0.9862499833106995}
INFO:ubt_solution.trainer:category_propensity 标签比例: 当前=21.56%, 平均=21.56%
INFO:ubt_solution.trainer:product_propensity 标签比例: 当前=2.64%, 平均=2.64%
INFO:ubt_solution.trainer:Epoch 13/15
Training:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.trainer:Batch 0: 开始训练
INFO:ubt_solution.trainer:Batch 0: 品类倾向性标签比例 = 21.56%
INFO:ubt_solution.trainer:Batch 0: 产品倾向性标签比例 = 2.56%
INFO:ubt_solution.model:品类倾向性: 883/4096 样本有标签 (21.56%)
INFO:ubt_solution.model:产品倾向性: 105/4096 样本有标签 (2.56%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05336106941103935
Training:  33%|███▎      | 1/3 [00:26<00:53, 26.54s/it]INFO:ubt_solution.trainer:Batch 1: 开始训练
INFO:ubt_solution.model:品类倾向性: 933/4096 样本有标签 (22.78%)
INFO:ubt_solution.model:产品倾向性: 110/4096 样本有标签 (2.69%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05334113910794258
Training:  67%|██████▋   | 2/3 [00:27<00:11, 11.43s/it]INFO:ubt_solution.trainer:Batch 2: 开始训练
INFO:ubt_solution.model:品类倾向性: 340/1808 样本有标签 (18.81%)
INFO:ubt_solution.model:产品倾向性: 49/1808 样本有标签 (2.71%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.053303319960832596
Training: 100%|██████████| 3/3 [00:27<00:00,  6.39s/it]Training: 100%|██████████| 3/3 [00:27<00:00,  9.31s/it]
INFO:ubt_solution.trainer:total_loss: 533.4246485829353, total_samples: 10000
INFO:ubt_solution.trainer:Epoch average loss: 0.0533
INFO:ubt_solution.trainer:训练集 category_propensity 标签比例: 21.56%
INFO:ubt_solution.trainer:训练集 product_propensity 标签比例: 2.64%
INFO:ubt_solution.trainer:Epoch average churn_loss: 0.0689
INFO:ubt_solution.trainer:Epoch average category_propensity_loss: 0.0261
INFO:ubt_solution.trainer:Epoch average product_propensity_loss: 0.0287
Validation:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.model:品类倾向性: 1185/4096 样本有标签 (28.93%)
INFO:ubt_solution.model:产品倾向性: 152/4096 样本有标签 (3.71%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  33%|███▎      | 1/3 [00:49<01:38, 49.23s/it]INFO:ubt_solution.model:品类倾向性: 707/4096 样本有标签 (17.26%)
INFO:ubt_solution.model:产品倾向性: 77/4096 样本有标签 (1.88%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  67%|██████▋   | 2/3 [00:49<00:20, 20.44s/it]INFO:ubt_solution.model:品类倾向性: 264/1808 样本有标签 (14.60%)
INFO:ubt_solution.model:产品倾向性: 35/1808 样本有标签 (1.94%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation: 100%|██████████| 3/3 [00:49<00:00, 11.16s/it]Validation: 100%|██████████| 3/3 [00:49<00:00, 16.60s/it]
INFO:ubt_solution.trainer:churn_loss improved: 0.0688
INFO:ubt_solution.trainer:category_propensity_loss improved: 0.0247
INFO:ubt_solution.trainer:product_propensity_loss improved: 0.0270
INFO:ubt_solution.trainer:New best churn_auc: 0.6065
INFO:ubt_solution.trainer:保存最佳模型，验证损失: 0.0527
INFO:ubt_solution.trainer:Validation metrics: {'val_loss': 0.05268948757648468, 'churn_loss': 0.06878418897390366, 'category_propensity_loss': 0.02469772633612156, 'product_propensity_loss': 0.027032244300842286, 'churn_auc': 0.6064637303352356, 'category_propensity_accuracy': 0.9865862727165222, 'category_propensity_pos_accuracy': 0.9865862727165222, 'product_propensity_accuracy': 0.9862499833106995, 'product_propensity_pos_accuracy': 0.9862499833106995}
INFO:ubt_solution.trainer:category_propensity 标签比例: 当前=21.56%, 平均=21.56%
INFO:ubt_solution.trainer:product_propensity 标签比例: 当前=2.64%, 平均=2.64%
INFO:ubt_solution.trainer:Epoch 14/15
Training:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.trainer:Batch 0: 开始训练
INFO:ubt_solution.trainer:Batch 0: 品类倾向性标签比例 = 21.26%
INFO:ubt_solution.trainer:Batch 0: 产品倾向性标签比例 = 2.73%
INFO:ubt_solution.model:品类倾向性: 871/4096 样本有标签 (21.26%)
INFO:ubt_solution.model:产品倾向性: 112/4096 样本有标签 (2.73%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05318610742688179
Training:  33%|███▎      | 1/3 [00:26<00:53, 26.98s/it]INFO:ubt_solution.trainer:Batch 1: 开始训练
INFO:ubt_solution.model:品类倾向性: 869/4096 样本有标签 (21.22%)
INFO:ubt_solution.model:产品倾向性: 103/4096 样本有标签 (2.51%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05312030017375946
Training:  67%|██████▋   | 2/3 [00:27<00:11, 11.61s/it]INFO:ubt_solution.trainer:Batch 2: 开始训练
INFO:ubt_solution.model:品类倾向性: 416/1808 样本有标签 (23.01%)
INFO:ubt_solution.model:产品倾向性: 49/1808 样本有标签 (2.71%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05310966819524765
Training: 100%|██████████| 3/3 [00:28<00:00,  6.49s/it]Training: 100%|██████████| 3/3 [00:28<00:00,  9.46s/it]
INFO:ubt_solution.trainer:total_loss: 531.4533256292343, total_samples: 10000
INFO:ubt_solution.trainer:Epoch average loss: 0.0531
INFO:ubt_solution.trainer:训练集 category_propensity 标签比例: 21.56%
INFO:ubt_solution.trainer:训练集 product_propensity 标签比例: 2.64%
INFO:ubt_solution.trainer:Epoch average churn_loss: 0.0689
INFO:ubt_solution.trainer:Epoch average category_propensity_loss: 0.0257
INFO:ubt_solution.trainer:Epoch average product_propensity_loss: 0.0281
Validation:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.model:品类倾向性: 1185/4096 样本有标签 (28.93%)
INFO:ubt_solution.model:产品倾向性: 152/4096 样本有标签 (3.71%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  33%|███▎      | 1/3 [00:49<01:39, 49.51s/it]INFO:ubt_solution.model:品类倾向性: 707/4096 样本有标签 (17.26%)
INFO:ubt_solution.model:产品倾向性: 77/4096 样本有标签 (1.88%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  67%|██████▋   | 2/3 [00:49<00:20, 20.55s/it]INFO:ubt_solution.model:品类倾向性: 264/1808 样本有标签 (14.60%)
INFO:ubt_solution.model:产品倾向性: 35/1808 样本有标签 (1.94%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation: 100%|██████████| 3/3 [00:49<00:00, 11.22s/it]Validation: 100%|██████████| 3/3 [00:50<00:00, 16.69s/it]
INFO:ubt_solution.trainer:churn_loss improved: 0.0688
INFO:ubt_solution.trainer:category_propensity_loss improved: 0.0242
INFO:ubt_solution.trainer:product_propensity_loss improved: 0.0264
INFO:ubt_solution.trainer:New best churn_auc: 0.6094
INFO:ubt_solution.trainer:保存最佳模型，验证损失: 0.0525
INFO:ubt_solution.trainer:Validation metrics: {'val_loss': 0.052461812937259676, 'churn_loss': 0.06876110051870346, 'category_propensity_loss': 0.024160976845026015, 'product_propensity_loss': 0.02643168061673641, 'churn_auc': 0.6093868017196655, 'category_propensity_accuracy': 0.9865862727165222, 'category_propensity_pos_accuracy': 0.9865862727165222, 'product_propensity_accuracy': 0.9862499833106995, 'product_propensity_pos_accuracy': 0.9862499833106995}
INFO:ubt_solution.trainer:category_propensity 标签比例: 当前=21.56%, 平均=21.56%
INFO:ubt_solution.trainer:product_propensity 标签比例: 当前=2.64%, 平均=2.64%
INFO:ubt_solution.trainer:Epoch 15/15
Training:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.trainer:Batch 0: 开始训练
INFO:ubt_solution.trainer:Batch 0: 品类倾向性标签比例 = 21.58%
INFO:ubt_solution.trainer:Batch 0: 产品倾向性标签比例 = 2.39%
INFO:ubt_solution.model:品类倾向性: 884/4096 样本有标签 (21.58%)
INFO:ubt_solution.model:产品倾向性: 98/4096 样本有标签 (2.39%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05303744599223137
Training:  33%|███▎      | 1/3 [00:27<00:54, 27.19s/it]INFO:ubt_solution.trainer:Batch 1: 开始训练
INFO:ubt_solution.model:品类倾向性: 874/4096 样本有标签 (21.34%)
INFO:ubt_solution.model:产品倾向性: 113/4096 样本有标签 (2.76%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.052931856364011765
Training:  67%|██████▋   | 2/3 [00:28<00:11, 11.70s/it]INFO:ubt_solution.trainer:Batch 2: 开始训练
INFO:ubt_solution.model:品类倾向性: 398/1808 样本有标签 (22.01%)
INFO:ubt_solution.model:产品倾向性: 53/1808 样本有标签 (2.93%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
INFO:ubt_solution.trainer:loss: 0.05281815305352211
Training: 100%|██████████| 3/3 [00:28<00:00,  6.54s/it]Training: 100%|██████████| 3/3 [00:28<00:00,  9.53s/it]
INFO:ubt_solution.trainer:total_loss: 529.5454831719398, total_samples: 10000
INFO:ubt_solution.trainer:Epoch average loss: 0.0530
INFO:ubt_solution.trainer:训练集 category_propensity 标签比例: 21.56%
INFO:ubt_solution.trainer:训练集 product_propensity 标签比例: 2.64%
INFO:ubt_solution.trainer:Epoch average churn_loss: 0.0689
INFO:ubt_solution.trainer:Epoch average category_propensity_loss: 0.0252
INFO:ubt_solution.trainer:Epoch average product_propensity_loss: 0.0277
Validation:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.model:品类倾向性: 1185/4096 样本有标签 (28.93%)
INFO:ubt_solution.model:产品倾向性: 152/4096 样本有标签 (3.71%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  33%|███▎      | 1/3 [00:50<01:40, 50.32s/it]INFO:ubt_solution.model:品类倾向性: 707/4096 样本有标签 (17.26%)
INFO:ubt_solution.model:产品倾向性: 77/4096 样本有标签 (1.88%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation:  67%|██████▋   | 2/3 [00:50<00:20, 20.88s/it]INFO:ubt_solution.model:品类倾向性: 264/1808 样本有标签 (14.60%)
INFO:ubt_solution.model:产品倾向性: 35/1808 样本有标签 (1.94%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Validation: 100%|██████████| 3/3 [00:50<00:00, 11.41s/it]Validation: 100%|██████████| 3/3 [00:50<00:00, 16.96s/it]
INFO:ubt_solution.trainer:churn_loss improved: 0.0687
INFO:ubt_solution.trainer:category_propensity_loss improved: 0.0236
INFO:ubt_solution.trainer:product_propensity_loss improved: 0.0258
INFO:ubt_solution.trainer:New best churn_auc: 0.6118
INFO:ubt_solution.trainer:保存最佳模型，验证损失: 0.0522
INFO:ubt_solution.trainer:Validation metrics: {'val_loss': 0.052234374737739564, 'churn_loss': 0.06873961099386215, 'category_propensity_loss': 0.023621882006525992, 'product_propensity_loss': 0.02582941411137581, 'churn_auc': 0.6118075251579285, 'category_propensity_accuracy': 0.9865862727165222, 'category_propensity_pos_accuracy': 0.9865862727165222, 'product_propensity_accuracy': 0.9862499833106995, 'product_propensity_pos_accuracy': 0.9862499833106995}
INFO:ubt_solution.trainer:category_propensity 标签比例: 当前=21.56%, 平均=21.56%
INFO:ubt_solution.trainer:product_propensity 标签比例: 当前=2.64%, 平均=2.64%
INFO:__main__:生成用户嵌入向量...
Generating embeddings:   0%|          | 0/3 [00:00<?, ?it/s]INFO:ubt_solution.model:品类倾向性: 875/4096 样本有标签 (21.36%)
INFO:ubt_solution.model:产品倾向性: 104/4096 样本有标签 (2.54%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Generating embeddings:  33%|███▎      | 1/3 [00:26<00:53, 26.62s/it]INFO:ubt_solution.model:品类倾向性: 880/4096 样本有标签 (21.48%)
INFO:ubt_solution.model:产品倾向性: 117/4096 样本有标签 (2.86%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Generating embeddings:  67%|██████▋   | 2/3 [00:26<00:11, 11.12s/it]INFO:ubt_solution.model:品类倾向性: 401/1808 样本有标签 (22.18%)
INFO:ubt_solution.model:产品倾向性: 43/1808 样本有标签 (2.38%)
INFO:ubt_solution.model:动态任务权重: 流失=0.62, 品类=0.19, 产品=0.19
Generating embeddings: 100%|██████████| 3/3 [00:27<00:00,  6.10s/it]Generating embeddings: 100%|██████████| 3/3 [00:27<00:00,  9.06s/it]
INFO:__main__:Saving embeddings
INFO:__main__:完成！
